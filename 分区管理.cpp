#include<iostream>
#include<ctime>
#include<cstdlib>
#include<vector>
#include<string>
#include<algorithm>
#include<limits>
#include <iomanip>  // å¼•å…¥è¾“å…¥è¾“å‡ºæ ¼å¼æ§åˆ¶åº“
#include <chrono> // æ—¶é—´åº“
#include <thread> // è·¨å¹³å°å…¼å®¹çš„å¤šçº¿ç¨‹åº“

using namespace std;

// å®šä¹‰å…¨å±€å¸¸é‡
#define n 10        // å·²åˆ†é…åŒºè¡¨æœ€å¤§æ¡ç›®æ•°
#define m 10        // ç©ºé—²åŒºè¡¨æœ€å¤§æ¡ç›®æ•°
#define L 1048576   // æ€»å†…å­˜å¤§å°1MBï¼ˆ1024*1024ï¼‰

// ä½œä¸šç±»
class Works {
public:
    // æ„é€ å‡½æ•°
    Works() {
        srand(time(0));  // åˆå§‹åŒ–éšæœºç§å­ï¼Œä½¿ç”¨å½“å‰æ—¶é—´
        cout << endl << n << "ä¸ªä½œä¸šå†…å­˜çš„å¤§å°éšæœºåˆå§‹åŒ–è¯·è¾“å…¥Rï¼Œè¾“å…¥å…¶ä»–ä¸ºè‡ªå®šä¹‰ä½œä¸šä¿¡æ¯ï¼š";
        string choice;
        cin >> choice;
        cin.ignore(numeric_limits<streamsize>::max(),  '\n');//while (getchar() != '\n'); Cè¯­è¨€é£æ ¼ æ¸…ç©ºè¾“å…¥ç¼“å†²åŒº
	    if(choice[0] == 'r' || choice[0] == 'R') initialize_jobs();  // åˆå§‹åŒ–ä½œä¸šé˜Ÿåˆ—
        else customize_jobs();  // è‡ªå®šä¹‰ä½œä¸šé˜Ÿåˆ—
        print_jobs();  // æ‰“å°ä½œä¸šé˜Ÿåˆ—
    }
    // ä½œä¸šç»“æ„
    struct Job{
        string name;    // ä½œä¸šåç§°
        float size;     // éœ€æ±‚å†…å­˜å¤§å°
        int flag;       // çŠ¶æ€æ ‡è®°ï¼š0-æœªåˆ†é… 1-å·²åˆ†é… 2-å·²å›æ”¶
        int id;         // ä½œä¸šç¼–å·
        Job() = default; // æ˜¾å¼å®šä¹‰é»˜è®¤æ„é€ å‡½æ•° 
		Job(string N, float S, int F, int i) : name(move(N)), size(S), flag(F), id(i) {}// // ç§»åŠ¨æ„é€ å‡½æ•°
    };
    // ä¿®æ”¹ä½œä¸šä¿¡æ¯
	void modify_jobs(int i, const int& F = 404, const float& resize = -1, const string& rename = ""){ // ç”¨å¼•ç”¨ä¼ å…¥é¿å…ä¸å¿…è¦çš„æ‹·è´ void modify_jobs(int i, string rename, float resize, int F)
		if (!rename.empty()) jobs.at(i).name = rename;
		if (resize >= 0) jobs.at(i).size = resize;
		if (F != 404) jobs.at(i).flag = F;
	}
	//å¯»æ‰¾å¤„äºä¸€å®šçŠ¶æ€ä¸‹çš„ä½œä¸šè¿”å›å…¶ä¸‹æ ‡
	vector<int> find_jobs(int targetFlag){
		state.clear();
		vector<Job>::iterator it = jobs.begin(); // å¯ä»¥ç”¨è‡ªåŠ¨è¯†åˆ«ç±»å‹çš„auto itä»£æ›¿iterator it(éœ€æ˜¾å¼å£°æ˜è¿­ä»£å™¨ç±»å‹ï¼ˆå¦‚ vector<int>::iteratorï¼‰ï¼Œæ˜ç¡®æŒ‡å®šå®¹å™¨å…ƒç´ çš„è®¿é—®æ–¹å¼)
    	while (true) {
        	// ä½¿ç”¨ Lambda è¡¨è¾¾å¼å®šä¹‰åŒ¹é…æ¡ä»¶
        	it = find_if(it, jobs.end(), 
							[targetFlag](const Job& j) {
            					return j.flag == targetFlag;
        					}
						);
        	if (it == jobs.end()) break; // æœªæ‰¾åˆ°è·³å‡ºå¾ªç¯
        	// è®¡ç®—å½“å‰å…ƒç´ çš„ä¸‹æ ‡
        	state.push_back(distance(jobs.begin(), it));
        	++it; // è·³è¿‡å·²æ‰¾åˆ°çš„å…ƒç´ ï¼Œç»§ç»­å‘åæŸ¥æ‰¾
    	}
    	return state;
	}
	// è¿”å›ä½œä¸šé˜Ÿåˆ—æˆ–å•ä¸ªä½œä¸šçš„æŒ‡é’ˆå¯ä¾›å¤–éƒ¨ä¿®æ”¹
    vector<Job>* get_jobs() {
        return &jobs;
    }                                                                                                
    Job* get_jobs(int i) {
        return &jobs.at(i); 
    }
    // è¿”å›ä½œä¸šé˜Ÿåˆ—æˆ–å•ä¸ªä½œä¸š
    vector<Job> getjobs() {
        return jobs;
    }                                                                                                
    Job getjobs(int i) {
        return jobs.at(i);//return jobs[i]; 
    }
    // æ‰“å°ä½œä¸šé˜Ÿåˆ—
    void print_jobs() {
        // éå†ä½œä¸šé˜Ÿåˆ—çš„æ¯ä¸ªä½œä¸š
        cout << "\nä½œä¸šé˜Ÿåˆ—ï¼š";
        if(jobs.empty()) cout << "æ— " << endl;
		else {
			cout << "\nç¼–å·\tä½œä¸šåç§°\tå†…å­˜éœ€æ±‚\tçŠ¶æ€" << endl;
        	for (int i = 0; i < jobs.size(); i++) {
        // è¾“å‡ºä½œä¸šåç§°ã€å†…å­˜éœ€æ±‚å’ŒçŠ¶æ€
            	cout << " " << jobs.at(i).id << "\t" << jobs.at(i).name << "\t\t" << jobs.at(i).size << "\t\t" << jobs.at(i).flag;
				switch (jobs.at(i).flag){
					case 0: cout << "ï¼ˆæœªåˆ†é…ï¼‰"; break;
					case 1: cout << "ï¼ˆå·²åˆ†é…ï¼‰"; break;
					case 2: cout << "ï¼ˆå·²å›æ”¶ï¼‰"; break;
					default: cout << "ï¼ˆæœªå®šä¹‰çŠ¶æ€ï¼‰";
				}
				cout << endl;  
        	} 
		}
    }
    // ææ„å‡½æ•°
    ~Works() {
        jobs.clear();  // æ¸…ç©ºä½œä¸šé˜Ÿåˆ—
        vector<Job>().swap(jobs);  // å½»åº•é‡Šæ”¾å†…å­˜ï¼ˆé€šè¿‡ä¸ç©ºå®¹å™¨äº¤æ¢æ•°æ®å®ç°ï¼‰
        state.clear();
        vector<int>().swap(state);
		cout << "\nä½œä¸šç±»å·²é”€æ¯\n" << endl;  // è¾“å‡ºé”€æ¯ä¿¡æ¯
    }
private:
    vector<Job> jobs{n};  // ä½œä¸šè¡¨ï¼ˆåˆå§‹åŒ–ä¸º10ä¸ªä½œä¸šï¼‰æå‰åˆ†é…è‡³å°‘ 10 ä¸ªå…ƒç´ çš„ç©ºé—´ï¼Œé¿å…å¤šæ¬¡æ‰©å®¹
    vector<int> state;
    void initialize_jobs() {//éšæœºå†…å­˜å¤§å°
        // cout << "\nå°†éšæœºåˆ†é…" << n << "ä¸ªä½œä¸šçš„å†…å­˜éœ€æ±‚ï¼ˆé»˜è®¤èŒƒå›´æ˜¯1åˆ°L/2ï¼ŒL=1MBï¼Œå³1024*1024ï¼‰" << endl;
        cout << "\nå°†éšæœºåˆ†é…" << n << "ä¸ªä½œä¸šçš„å†…å­˜éœ€æ±‚ï¼ˆä¸ºå®ç°åŠ¨æ€å†…å­˜ç®¡ç†çš„å›æ”¶åŠŸèƒ½ï¼Œé»˜è®¤èŒƒå›´æ˜¯L/8åˆ°L*5/8 - 1ï¼ŒL=1MBï¼Œå³1024*1024ï¼‰" << endl;
        // éå†ä½œä¸šé˜Ÿåˆ—çš„æ¯ä¸ªä½œä¸š
        for (int i = 0; i < n; i++) {
        // ç”Ÿæˆä½œä¸šåç§°ï¼Œæ ¼å¼ä¸º"JOB1"åˆ°"JOB10"
            jobs[i].name = "JOB" + to_string(i + 1);
        // ç”Ÿæˆéšæœºå†…å­˜éœ€æ±‚ï¼ŒèŒƒå›´æ˜¯1åˆ°L/2
            jobs[i].size = (rand() % (L/2)) + L/8; // jobs[i].size = (rand() % (L/2)) + 1;  
        // åˆå§‹çŠ¶æ€ä¸ºæœªåˆ†é…
            jobs[i].flag = 0;
        // ç”Ÿæˆä½œä¸šç¼–å·ï¼ŒèŒƒå›´æ˜¯1åˆ°10
            jobs[i].id = i + 1;
        }
    }
    void customize_jobs() {//è‡ªå®šä¹‰ä½œä¸šä¿¡æ¯
        cout << "\nå°†è‡ªå®šä¹‰è‹¥å¹²ä¸ªä½œä¸šçš„åˆå§‹ä¿¡æ¯ï¼Œä½œä¸šåä¸ºç©ºå­—ç¬¦ä¸²è¡¨ç¤ºé€€å‡ºè‡ªå®šä¹‰ä½œä¸š" << endl << endl;
        // éå†ä½œä¸šé˜Ÿåˆ—çš„æ¯ä¸ªä½œä¸š
        for(int i = 0; ;i++) {
			string N;
            float size;
            int F;
        // è¾“å…¥ä½œä¸šåç§°ï¼Œè¾“å…¥ç©ºå­—ç¬¦ä¸²è¡¨ç¤ºé€€å‡ºè‡ªå®šä¹‰ä½œä¸š
            cout << "\nè¯·è¾“å…¥ä½œä¸š" << i + 1 << "çš„åç§°ï¼ˆè¾“å…¥ç©ºå­—ç¬¦ä¸²ï¼Œå³ç›´æ¥æŒ‰å›è½¦è¡¨ç¤ºé€€å‡ºï¼‰ï¼š";
            getline(cin, N); // è¯»å–æ•´è¡Œè¾“å…¥ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€‚getlineå‡½æ•°é€šå¸¸ç”¨äºè¯»å–å­—ç¬¦ä¸²ï¼Œç›´åˆ°é‡åˆ°æ¢è¡Œç¬¦ï¼Œç„¶åä¸¢å¼ƒæ¢è¡Œç¬¦ã€‚æ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä½¿ç”¨getlineä¹‹åï¼Œç¼“å†²åŒºé‡Œä¸ä¼šæœ‰æ®‹ç•™çš„æ¢è¡Œç¬¦ï¼Œè¿™å¯èƒ½æ„å‘³ç€ä¸éœ€è¦å†æ¸…é™¤ç¼“å­˜äº†
            if (N.empty()) break;  // è¾“å…¥ç©ºå­—ç¬¦ä¸²é€€å‡º
            if(i >= 10) jobs.emplace_back(" ", 0.0f, 0, 0);// ç©ºé—´ä¸è¶³æ—¶ç›´æ¥æ„é€ ï¼Œé¿å…æ‹·è´ string
            jobs[i].name = N;
            //cin.ignore(numeric_limits<streamsize>::max(),  '\n'); // while (getchar() != '\n'); å¾ªç¯æ¸…ç©ºæ‰€æœ‰å­—ç¬¦ï¼ˆæ¯æ¬¡getcharä»…æ¸…é™¤ä¸€ä¸ªå­—ç¬¦ï¼ŒCé£æ ¼ï¼Œæ•ˆç‡ä½ï¼‰

        // è¾“å…¥å†…å­˜éœ€æ±‚
            cout << "è¯·è¾“å…¥ä½œä¸š" << jobs[i].name << "çš„å†…å­˜éœ€æ±‚ï¼š";
            while(true) {
                cin >> size;
                if (cin.fail() || size < 0)  {  // æ£€æµ‹è¾“å…¥æ˜¯å¦å¤±è´¥ï¼ˆå¦‚è¾“å…¥å­—æ¯ï¼Œè´Ÿæ•°ï¼‰
                    cin.clear();    // é‡ç½®é”™è¯¯çŠ¶æ€ 
                    cin.ignore(numeric_limits<streamsize>::max(),  '\n');  // æ¸…ç©ºç¼“å†²åŒºç›´è‡³æ¢è¡Œç¬¦ // cin.ignore();ä»…æ¸…ç©º1ä¸ªå­—ç¬¦ï¼ˆå¯èƒ½æ®‹ç•™æ•°æ®ï¼‰
                    cerr << "æ‰€å å†…å­˜ä¸èƒ½ä¸ºå­—ç¬¦ä¸²æˆ–è´Ÿæ•°ï¼Œè¯·é‡æ–°è¾“å…¥ï¼š";
                } else {
                    cin.ignore(numeric_limits<streamsize>::max(),  '\n');  // æ¸…é™¤å¤šä½™å­—ç¬¦ï¼ˆå¦‚å›è½¦ï¼‰
                    break;  // è¾“å…¥æ­£ç¡®ï¼Œè·³å‡ºå¾ªç¯
                }
            }
            jobs[i].size = size;  
        // è¾“å…¥åˆå§‹çŠ¶æ€
            cout << "è¯·è¾“å…¥ä½œä¸š" << jobs[i].name << "çš„åˆå§‹çŠ¶æ€ï¼ˆ0-æœªåˆ†é…ï¼Œ1-å·²åˆ†é…ï¼Œ2-å·²å›æ”¶ï¼Œå…¶ä»–-æœªå®šä¹‰ï¼‰ï¼š";
            while(1) {
            	cin >> F;
            	if (cin.fail())  {  // æ£€æµ‹è¾“å…¥æ˜¯å¦å¤±è´¥ï¼ˆå¦‚è¾“å…¥å­—æ¯ï¼‰
                    cin.clear();    // é‡ç½®é”™è¯¯çŠ¶æ€ 
                    cin.ignore(numeric_limits<streamsize>::max(),  '\n');  // æ¸…ç©ºç¼“å†²åŒºç›´è‡³æ¢è¡Œç¬¦ // cin.ignore();ä»…æ¸…ç©º1ä¸ªå­—ç¬¦ï¼ˆå¯èƒ½æ®‹ç•™æ•°æ®ï¼‰
                    cerr << "è¯·é‡æ–°è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼š";
                } else {
                    cin.ignore(numeric_limits<streamsize>::max(),  '\n');  // æ¸…é™¤å¤šä½™å­—ç¬¦ï¼ˆå¦‚å›è½¦ï¼‰
                    break;  // è¾“å…¥æ­£ç¡®ï¼Œè·³å‡ºå¾ªç¯
                }
			}
            jobs[i].flag = F;
            jobs[i].id = i + 1;
            if(i < 10) vector<Job>(jobs).swap(jobs); // é€šè¿‡æ‹·è´æ„é€ ç”Ÿæˆä¸€ä¸ªä¸´æ—¶ vectorï¼Œå…¶å®¹é‡ç²¾ç¡®ç­‰äºå½“å‰å…ƒç´ æ•°é‡ï¼ˆæ— å†—ä½™å†…å­˜ï¼‰ï¼Œå†ä¸åŸå®¹å™¨äº¤æ¢å†…å®¹ã€‚ä¸´æ—¶å®¹å™¨é”€æ¯æ—¶é‡Šæ”¾åŸå®¹å™¨çš„å†—ä½™å†…å­˜
						// jobs.shrink_to_fit(); // é‡Šæ”¾å®¹å™¨å¤šä½™å®¹é‡ï¼ˆåˆå§‹åŒ–ä¸º10ï¼‰ï¼Œè¯¥ä»£ç ä»…è¡¨ç¤ºè¯·æ±‚ï¼Œç¼–è¯‘å™¨ä¸ä¸€å®šä¼šé‡Šæ”¾
        }
        system("cls"); // æ¸…å±
    }
    // æµ‹è¯•ä»£ç æ ·ä¾‹
    /*
int main() {
    Works w;  // åˆ›å»ºä½œä¸šå¯¹è±¡
    
    cout<<(*w.get_jobs())[0].name<<endl;
    cout<<w.get_jobs(0)->size<<endl;  // è¾“å‡ºç¬¬ä¸€ä¸ªä½œä¸šçš„åç§°
    
	cout<<w.getjobs()[1].name<<endl;
	cout<<w.getjobs().at(2).name<<endl;
    cout<<w.getjobs(1).size<<endl;
    
	w.get_jobs()->at(0).name = "fuck";
	(*w.get_jobs(0)).flag = 100;
	
	w.modify_jobs(1,0,200,"shit");
	w.modify_jobs(2,404,-2,"shit");
	w.modify_jobs(3,0,500);
	w.modify_jobs(4,67);
	//w.modify_jobs(4,0);
	//vector<works::Job> jobs = w.getjobs();  // è·å–ä½œä¸šé˜Ÿåˆ—
    //cout<<jobs[0].name<<endl;  // è¾“å‡ºç¬¬ä¸€ä¸ªä½œä¸šçš„åç§°
	//works::Job job = w.getjobs(0);  // è·å–ç¬¬ä¸€ä¸ªä½œä¸š
    //job.flag = 1;  // å°†ç¬¬ä¸€ä¸ªä½œä¸šçš„çŠ¶æ€æ ‡è®°ä¸ºå·²åˆ†é…
    //jobs[0].name = "asd";
    //cout<<jobs[0].name<<endl;
    
    for (const auto& elem : w.find_jobs(0)) { // åªè¯»éå†ï¼ˆé¿å…æ‹·è´å¼€é”€ï¼‰
    	cout << elem << " ";
	}
    
    w.print_jobs();  // æ‰“å°ä½œä¸šé˜Ÿåˆ—
    return 0;  // ç¨‹åºç»“æŸ 
}
    */ 
   
};
// å·²åˆ†é…åŒºç±»
class Used {
public:
    // æ„é€ å‡½æ•°
    Used() {
    	//initialize_used_table();
    	cout << endl << "å°†é»˜è®¤è®¾ç½®" << n << "ä¸ªå·²åˆ†é…åŒº" << endl;
    	print_used_table();
    }
    // å·²åˆ†é…åŒºè¡¨æ¡ç›®ç»“æ„
    struct UsedEntry{
        string name;    // ä½œä¸šåç§°
        float address;  // èµ·å§‹åœ°å€
        float length;   // é•¿åº¦ï¼ˆå­—èŠ‚ï¼‰ 
        int flag;       // çŠ¶æ€æ ‡è®°ï¼š0-ç©º 1-å·²åˆ†é… å…¶ä»–-æœªå®šä¹‰
        int id;         // è®°å½•ä½œä¸šç¼–å·
        UsedEntry() = default; // æ˜¾å¼å®šä¹‰é»˜è®¤æ„é€ å‡½æ•°	
        UsedEntry(string N, float A, float l, int F, int i) : name(move(N)), address(A), length(l), flag(F), id(i) {} // ç§»åŠ¨æ„é€ å‡½æ•°
    };
    // è·å–å·²åˆ†é…åŒºè¡¨ï¼ˆåªè¯»ï¼‰
    vector<UsedEntry> get_used_table() const {
        return used_table;
    }
    // ä¿®æ”¹å·²åˆ†é…åŒºä¿¡æ¯
    void modify_used_table(int& i, const string& name = "", const float& a = -1, const float& l = -1, const int& I = 0, const int& F = 1){ // ç”¨å¼•ç”¨ä¼ å…¥é¿å…ä¸å¿…è¦çš„æ‹·è´
        /* å·¦å€¼ï¼ˆT&ï¼‰å¼•ç”¨ï¼šå…è®¸ç›´æ¥è®¿é—®å’Œä¿®æ”¹å·¦å€¼ï¼Œé€šå¸¸ç”¨äºå‡½æ•°å‚æ•°ä¼ é€’å’Œè¿”å›å·¦å€¼
        // å³å€¼ï¼ˆT&&ï¼‰å¼•ç”¨ï¼šå…è®¸ç›´æ¥è®¿é—®å’Œä¿®æ”¹å³å€¼ï¼Œé€šå¸¸ç”¨äºå‡½æ•°å‚æ•°ä¼ é€’å’Œè¿”å›å³å€¼
        // å·¦å€¼å¼•ç”¨é€šå¸¸ç”¨äºå‡½æ•°å‚æ•°ä¼ é€’å’Œè¿”å›å·¦å€¼ï¼Œå³å€¼å¼•ç”¨é€šå¸¸ç”¨äºå‡½æ•°å‚æ•°ä¼ é€’å’Œè¿”å›å³å€¼
        // å·¦å€¼å¼•ç”¨å¯ä»¥ç»‘å®šåˆ°å·¦å€¼ï¼ˆå¦‚å˜é‡ã€è¡¨è¾¾å¼ç­‰ï¼‰ï¼Œå³å€¼å¼•ç”¨å¯ä»¥ç»‘å®šåˆ°å³å€¼ï¼ˆå¦‚ä¸´æ—¶å¯¹è±¡ã€å­—é¢é‡ç­‰ï¼‰ 
        // é€šè¿‡const T& å¯ä»¥å®ç°åªè¯»è®¿é—®ï¼Œé€šè¿‡T&& å¯ä»¥å®ç°ç§»åŠ¨è¯­ä¹‰ï¼Œé¿å…ä¸å¿…è¦çš„æ‹·è´
1. å·¦å€¼/å³å€¼çš„æ ¸å¿ƒåŒºåˆ«
å®šä¹‰ï¼š
å·¦å€¼ï¼šæœ‰æŒä¹…å†…å­˜åœ°å€çš„è¡¨è¾¾å¼ï¼ˆå˜é‡ã€æ•°ç»„å…ƒç´ ï¼‰
å³å€¼ï¼šä¸´æ—¶è®¡ç®—ç»“æœæˆ–å­—é¢å¸¸é‡ï¼ˆ5ã€a+bçš„ç»“æœï¼‰
å…³é”®äº‹å®ï¼š
C++æ ‡å‡†è¦æ±‚éå¸¸é‡å¼•ç”¨å¿…é¡»ç»‘å®šåˆ°å·¦å€¼ï¼ˆé˜²æ­¢æ„å¤–ä¿®æ”¹ä¸´æ—¶å¯¹è±¡ï¼‰
æœ€æ–°è¶‹åŠ¿ï¼šC++17å¼•å…¥"ä¿è¯æ‹·è´æ¶ˆé™¤"ä¼˜åŒ–ä¸´æ—¶å¯¹è±¡æ€§èƒ½
ç°å®æ¡ˆä¾‹ï¼š
cpp
å¤åˆ¶
void modify(int& x);  
modify(5); // é”™è¯¯ï¼š5æ˜¯å³å€¼  
äº‰è®®ï¼šéƒ¨åˆ†å¼€å‘è€…è®¤ä¸ºç¼–è¯‘å™¨åº”è‡ªåŠ¨åˆ›å»ºä¸´æ—¶å˜é‡ï¼ˆPython/Javaé£æ ¼ï¼‰ï¼Œä½†C++åšæŒæ˜¾å¼æ§åˆ¶
2. å¸¸é‡å¼•ç”¨çš„ç‰¹æ®Šè±å…
å®šä¹‰ï¼šconst T&å¯ç»‘å®šå³å€¼ï¼Œå»¶é•¿ä¸´æ—¶å¯¹è±¡ç”Ÿå‘½å‘¨æœŸè‡³å¼•ç”¨ä½œç”¨åŸŸç»“æŸ
å…³é”®æœºåˆ¶ï¼š
ç¼–è¯‘å™¨éšå¼åˆ›å»ºconstä¸´æ—¶å‰¯æœ¬ï¼ˆC++æ ‡å‡†æ¡æ¬¾Â§9.4.4ï¼‰
æœ€æ–°å‘å±•ï¼šC++20ç¦æ­¢å¸¸é‡å¼•ç”¨ç»‘å®šåˆ°volatileå³å€¼ï¼ˆå¼ºåŒ–ç±»å‹å®‰å…¨ï¼‰
å·¥ç¨‹æ„ä¹‰ï¼š
cpp
å¤åˆ¶
const std::string& s = "hello"; // åˆæ³•ï¼šåˆ›å»ºä¸´æ—¶stringå¯¹è±¡  
æ€§èƒ½æ•°æ®ï¼šä¸´æ—¶å¯¹è±¡æ‹·è´åœ¨x86æ¶æ„æ¶ˆè€—çº¦12-15ä¸ªæ—¶é’Ÿå‘¨æœŸï¼ˆAgner Fogä¼˜åŒ–æ‰‹å†Œï¼‰
3. ç°ä»£C++çš„è§£å†³æ–¹æ¡ˆï¼ˆC++11+ï¼‰
å³å€¼å¼•ç”¨ï¼š
è¯­æ³•T&&ï¼Œä¸“é—¨å¤„ç†ä¸´æ—¶å¯¹è±¡
ç§»åŠ¨è¯­ä¹‰ï¼šé¿å…æ·±æ‹·è´ï¼Œæå‡æ€§èƒ½40-60%ï¼ˆSTLå®¹å™¨å®æµ‹ï¼‰
è½¬å‘å¼•ç”¨ï¼š
æ¨¡æ¿ä¸­çš„auto&&å¯æ¥å—ä»»æ„å€¼ç±»åˆ«
å…³é”®åº”ç”¨ï¼šå®Œç¾è½¬å‘ï¼ˆstd::forwardï¼‰
è¡Œä¸šåº”ç”¨ï¼š
Google Abseilåº“ä¸­absl::string_viewå¹¿æ³›ä½¿ç”¨å¸¸é‡å¼•ç”¨å¤„ç†å­—ç¬¦ä¸²
Unreal Engineç¦æ­¢éå¸¸é‡å¼•ç”¨å‚æ•°ï¼ˆå¼ºåˆ¶ä½¿ç”¨æŒ‡é’ˆ/constå¼•ç”¨ï¼‰
        */
        /*if(i >= used_table.size()) {
        	cout << "è¯¥å·²åˆ†é…åŒºä¸å­˜åœ¨" << endl;
        	return;
        }*/
        if (i > n - 1) { // æ£€æŸ¥ç´¢å¼•æ˜¯å¦è¶…å‡ºèŒƒå›´
            size_t j = i + 1 - used_table.size(); // è®¡ç®—è¶…å‡ºéƒ¨åˆ†çš„ç´¢å¼•  size_tæ— ç¬¦å·æ•´æ•°ç±»å‹ï¼Œç”¨äºè¡¨ç¤ºå†…å­˜/å¯¹è±¡å¤§å°ï¼ˆsizeofè¿ç®—ç¬¦çš„è¿”å›ç±»å‹ï¼‰
            for (int I = 0; I < j; I++) used_table.emplace_back("", 0.0f, 0.0f, 0, 0); // ç©ºé—´ä¸è¶³æ—¶ç›´æ¥æ„é€ ï¼Œé¿å…æ‹·è´ string
        }
        if (!name.empty()) used_table.at(i).name = name; // ä½œä¸šåç§°
        if (a >= 0) used_table.at(i).address = a; // èµ·å§‹åœ°å€
        if (l >= 0) used_table.at(i).length = l; // é•¿åº¦
        if (I != 0) used_table.at(i).id = I; // å·²åˆ†é…åŒºç¼–å·
        used_table.at(i).flag = F; // é»˜è®¤çŠ¶æ€å·²åˆ†é…
        i++;
    }
    // è¿”å›å¾…å›æ”¶çš„å·²åˆ†é…åŒº
    vector<UsedEntry> decide_recycle(Works& w){
        vector<UsedEntry> recycle;
        vector<int> d = decide();
        recycle.resize(d.size()); // å­˜å‚¨å¾…å›æ”¶çš„å·²åˆ†é…åŒºï¼Œé¢„åˆ†é…åˆå§‹åŒ–
        // éå†å·²åˆ†é…åŒºè¡¨çš„æ¯ä¸ªæ¡ç›®
        for (size_t i = 0; i < d.size(); i++) {
            recycle.at(i) = used_table.at(d.at(i)); // å¤åˆ¶å·²åˆ†é…åŒºä¿¡æ¯åˆ°å›æ”¶è¡¨
            w.modify_jobs(recycle.at(i).id - 1, 2); // ä¿®æ”¹å¯¹åº”ä½œä¸šçš„çŠ¶æ€ä¸ºå·²å›æ”¶
        }
        print_used_table(); // æ‰“å°å·²åˆ†é…åŒºè¡¨
        return recycle; // è¿”å›å¾…å›æ”¶çš„å·²åˆ†é…åŒº
    }
    // æ‰“å°å·²åˆ†é…åŒºè¡¨
    void print_used_table() {
        // éå†å·²åˆ†é…åŒºè¡¨çš„æ¯ä¸ªæ¡ç›®
        cout << "\nå·²åˆ†é…åŒºè¡¨ï¼š";
        if(used_table.empty()) cout << "æ— " << endl; // è¾“å‡ºç©ºä¿¡æ¯
        else {
        	cout << "\nåºå·\tä½œä¸šåç§°\tèµ·å§‹åœ°å€\té•¿åº¦\t\tçŠ¶æ€" << endl;	
        	for (size_t i = 0; i < used_table.size(); i++) {
                cout << " " << i+1 << "\t" << used_table.at(i).name << "\t\t" << used_table.at(i).address << "\t\t" << used_table.at(i).length << "\t\t" << used_table.at(i).flag;
                switch (used_table.at(i).flag){
                	case 0: cout << "ï¼ˆç©ºï¼‰"; break;
                	case 1: cout << "ï¼ˆå·²åˆ†é…ï¼‰"; break;
                	default: cout << "ï¼ˆæœªå®šä¹‰ï¼‰";	
                }
                cout << endl;
        	}
        }
    }
    // ææ„å‡½æ•°
    ~Used() {
        used_table.clear();  // æ¸…ç©ºå·²åˆ†é…åŒºè¡¨
        vector<UsedEntry>().swap(used_table);  // å½»åº•é‡Šæ”¾å†…å­˜ï¼ˆé€šè¿‡ä¸ç©ºå®¹å™¨äº¤æ¢æ•°æ®å®ç°ï¼‰
        cout << "\nå·²åˆ†é…åŒºç±»å·²é”€æ¯" << endl;  // è¾“å‡ºé”€æ¯ä¿¡æ¯
    }
private:
    vector<UsedEntry> used_table{n};  // å·²åˆ†é…åŒºè¡¨
	// åˆå§‹åŒ–å·²åˆ†é…åŒºè¡¨
    void initialize_used_table() {
        cout << endl << "å°†é»˜è®¤è®¾ç½®" << n << "ä¸ªå·²åˆ†é…åŒº" << endl;
        // éå†å·²åˆ†é…åŒºè¡¨çš„æ¯ä¸ªæ¡ç›®
        for (int i = 0; i < n; i++) {
        // åˆå§‹åŒ–ä½œä¸šåç§°ä¸ºç©ºå­—ç¬¦ä¸²
            used_table[i].name = "" ;
        // åˆå§‹åœ°å€ä¸º0 åˆå§‹é•¿åº¦ä¸º0
            used_table[i].address = used_table[i].length = 0;
        // åˆå§‹çŠ¶æ€ä¸ºæœªåˆ†é…
            used_table[i].flag = 0;
        // åˆå§‹ç¼–å·ä¸º0
            used_table[i].id = 0; 	
        }
    }
    // å¯»æ‰¾å¤„äºä¸€å®šçŠ¶æ€ï¼ˆé»˜è®¤ä¸ºå·²åˆ†é…çŠ¶æ€ï¼‰ä¸‹çš„å·²åˆ†é…åŒºè¿”å›å…¶ä¸‹æ ‡
    vector<int> find_used_table(int&& targetFlag = 1){
    	vector<int> state;
    	auto it = used_table.begin(); // å¯ä»¥ç”¨è‡ªåŠ¨è¯†åˆ«ç±»å‹çš„auto itä»£æ›¿iterator it(éœ€æ˜¾å¼å£°æ˜è¿­ä»£å™¨ç±»å‹ï¼ˆå¦‚ vector<int>::iteratorï¼‰ï¼Œæ˜ç¡®æŒ‡å®šå®¹å™¨å…ƒç´ çš„è®¿é—®æ–¹å¼)
    	while (1) {
        	// ä½¿ç”¨ Lambda è¡¨è¾¾å¼å®šä¹‰åŒ¹é…æ¡ä»¶
        	it = find_if(it, used_table.end(),
							[targetFlag](const UsedEntry& u) {
            					return u.flag == targetFlag;
        					}
						); // è¿”å›ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ çš„è¿­ä»£å™¨ï¼Œè‹¥æ²¡æœ‰æ‰¾åˆ°åˆ™è¿”å›end()è¿­ä»£å™¨
        	if (it == used_table.end()) break; // æœªæ‰¾åˆ°è·³å‡ºå¾ªç¯
        	// è®¡ç®—å½“å‰å…ƒç´ çš„ä¸‹æ ‡
        	state.push_back(distance(used_table.begin(), it));
        	++it; // è·³è¿‡å·²æ‰¾åˆ°çš„å…ƒç´ ï¼Œç»§ç»­å‘åæŸ¥æ‰¾
    	}
    	return state;
    }
    // éšæœºå†³å®šæ˜¯å¦å›æ”¶å·²åˆ†é…åŒº
    vector<int> decide() {
        // å¯ä»¥é€šè¿‡ä¸¤ç§ç®—æ³•å®ç°
		/*
		vector<int> randomly_decide = find_used_table(); // å­˜å‚¨å·²åˆ†é…çŠ¶æ€çš„å·²åˆ†é…åŒºä¸‹æ ‡
        // éå†å·²åˆ†é…åŒºè¡¨çš„æ¯ä¸ªæ¡ç›®
        auto it = randomly_decide.begin(); // å¯ä»¥ç”¨è‡ªåŠ¨è¯†åˆ«ç±»å‹çš„auto itä»£æ›¿iterator it(éœ€æ˜¾å¼å£°æ˜è¿­ä»£å™¨ç±»å‹ï¼ˆå¦‚ vector<int>::iterator itï¼‰ï¼Œæ˜ç¡®æŒ‡å®šå®¹å™¨å…ƒç´ çš„è®¿é—®æ–¹å¼)
        while (it != randomly_decide.end()) {
            // éšæœºå†³å®šæ˜¯å¦å›æ”¶
            if (rand() % 2 == 0) it = randomly_decide.erase(it); // éšæœºæ•°ä¸º0åˆ™ä¸å›æ”¶ï¼Œåˆ é™¤è¯¥å…ƒç´   
            //vector::erase() è¿”å›è¢«åˆ é™¤å…ƒç´ çš„ä¸‹ä¸€ä¸ªæœ‰æ•ˆè¿­ä»£å™¨ã€‚åˆ é™¤å…ƒç´ åï¼Œåç»­å…ƒç´ å‰ç§»ï¼Œè¢«åˆ ä½ç½®ä¹‹åçš„è¿­ä»£å™¨å¤±æ•ˆã€‚å…³é”®æ¨¡å¼ï¼šå¾ªç¯ä¸­å¿…é¡»ç”¨è¿”å›å€¼æ›´æ–°è¿­ä»£å™¨
            else ++it; // éšæœºæ•°ä¸º1åˆ™å›æ”¶ï¼Œç»§ç»­å‘åæŸ¥æ‰¾
        }
        if(randomly_decide.empty()) cout << "\næœ¬è½®éšæœºå†³å®šæ— è¦å›æ”¶çš„å·²åˆ†é…åŒº" << endl; // è¾“å‡ºç©ºä¿¡æ¯
        else {
            cout << "\næœ¬è½®éšæœºå†³å®šå›æ”¶çš„å·²åˆ†é…åŒºçš„åºå·ï¼š";
            for (auto i = randomly_decide.begin(); i != randomly_decide.end(); i++) { // è¿­ä»£å™¨éå†
                cout << *i + 1 ; // è¾“å‡ºè¦å›æ”¶çš„å·²åˆ†é…åŒºåºå·
                int a = *i;// å› ä¸ºmodify_used_tableå‡½æ•°ä¼šè‡ªåŠ¨å¯¹aè‡ªå¢
                modify_used_table(a, "", -1.0f, -1.0f, 0, 0); // ä¿®æ”¹å·²åˆ†é…åŒºçŠ¶æ€ä¸ºç©º
                if (i != randomly_decide.end() - 1) cout << " "; // è¾“å‡ºç©ºæ ¼
                else cout << endl;
            }
        }
        return randomly_decide; // è¿”å›è¦éšæœºå›æ”¶çš„å·²åˆ†é…åŒºä¸‹æ ‡
        */
        
        vector<int> randomly_decide = find_used_table();
        for(int val: randomly_decide) { // èŒƒå›´ for å¾ªç¯
        	modify_used_table(val, "", -1, -1, 0, rand() % 2); // éšæœºä¿®æ”¹å·²åˆ†é…çŠ¶æ€çš„å·²åˆ†é…åŒºçŠ¶æ€
            val--; // å› ä¸ºmodify_used_tableå‡½æ•°ä¼šè‡ªåŠ¨å¯¹valè‡ªå¢
        }
        vector<int> decide = find_used_table(0); // æŸ¥æ‰¾ç©ºçŠ¶æ€çš„å·²åˆ†é…åŒº
        // æŸ¥æ‰¾ä¸¤ä¸ªå®¹å™¨çš„äº¤é›†éƒ¨åˆ†
        // 1.å…ˆå¯¹ä¸¤ä¸ªå®¹å™¨è¿›è¡Œæ’åºï¼Œç¡®ä¿å…ƒç´ é¡ºåºä¸€è‡´
        sort(randomly_decide.begin(), randomly_decide.end());
        sort(decide.begin(), decide.end());
        // 2. åˆ›å»ºç›®æ ‡å®¹å™¨ï¼ˆé¢„åˆ†é…ç©ºé—´ï¼‰
        vector<int> intersection; 
        intersection.resize(min(randomly_decide.size(), decide.size())); // intersection.reserve(min(randomly_decide.size(), decide.size()));
        //resize(n)ï¼šè°ƒæ•´å®¹å™¨ä¸­å…ƒç´ æ•°é‡ï¼ˆsizeï¼‰ï¼Œå¯èƒ½ä¿®æ”¹å®¹é‡ï¼ˆcapacityï¼‰ã€‚è‹¥n > sizeï¼Œæ–°å¢å…ƒç´ é»˜è®¤åˆå§‹åŒ–æˆ–æŒ‡å®šå€¼åˆå§‹åŒ–ï¼›è‹¥n < sizeï¼Œå°¾éƒ¨å…ƒç´ è¢«é”€æ¯ã€‚
        //reserve(n)ï¼šä»…è°ƒæ•´å®¹é‡ï¼ˆcapacityï¼‰ï¼Œä¸æ”¹å˜å…ƒç´ æ•°é‡ï¼ˆsizeï¼‰ã€‚é¢„åˆ†é…å†…å­˜ä»¥é¿å…é¢‘ç¹é‡åˆ†é…ã€‚è‹¥n > capacityï¼Œå®¹å™¨å®¹é‡å¢åŠ ï¼›è‹¥n < capacityï¼Œå®¹å™¨å®¹é‡ä¸å˜ã€‚   
        // æ³¨æ„ï¼šresize() ä¼šæ”¹å˜å®¹å™¨ä¸­å…ƒç´ çš„å€¼ï¼Œè€Œ reserve() ä¸ä¼šã€‚
        //resizeå¯èƒ½è§¦å‘éšå¼å†…å­˜åˆ†é…ï¼ˆå¦‚æ–°size > capacityæ—¶ï¼‰ï¼Œè€—æ—¶å¤æ‚åº¦ä¸ºğ‘‚(ğ‘›)ã€‚
        //reserveé€šè¿‡ä¸€æ¬¡æ€§é¢„åˆ†é…å†…å­˜ï¼Œå°†å¤šæ¬¡å†…å­˜åˆ†é…ä¼˜åŒ–ä¸ºå•æ¬¡ï¼ˆä¾‹å¦‚æ’å…¥1000ä¸ªå…ƒç´ æ—¶ï¼Œé¿å…å¤šæ¬¡æŒ‡æ•°çº§æ‰©å®¹ï¼‰ã€‚
        //æ ‡å‡†è¡Œä¸ºï¼šreserve(n)è‹¥n < capacityï¼Œå¤šæ•°å®ç°ä¸ä¼šç¼©å‡å®¹é‡ï¼ˆéœ€æ‰‹åŠ¨è°ƒç”¨shrink_to_fitï¼‰ã€‚ 
        // 3. ä½¿ç”¨ set_intersection ç®—æ³•æŸ¥æ‰¾äº¤é›†éƒ¨åˆ†
        auto it = set_intersection(randomly_decide.begin(), randomly_decide.end(), decide.begin(), decide.end(), intersection.begin());
        //set_intersection(randomly_decide.begin(), randomly_decide.end(), decide.begin(), decide.end(), back_inserter(intersection));
        //std::set_intersection çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼ŒæŒ‡å‘ç›®æ ‡å®¹å™¨ä¸­äº¤é›†å…ƒç´ èŒƒå›´çš„æœ«å°¾ï¼ˆå³æœ€åä¸€ä¸ªæœ‰æ•ˆäº¤é›†å…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½®ï¼‰ è¿™æ„å‘³ç€å¯ä»¥é€šè¿‡è¯¥è¿­ä»£å™¨ç¡®å®šå®é™…å†™å…¥çš„äº¤é›†å…ƒç´ æ•°é‡ï¼Œé¿å…å¤„ç†æ— æ•ˆæ•°æ®
        // 4. åˆ é™¤å¤šä½™ç©ºé—´
        intersection.resize(it  - intersection.begin());// intersection.erase(it, intersection.end());  ä¿ç•™äº¤é›†éƒ¨åˆ†ï¼Œåˆ é™¤å¤šä½™éƒ¨åˆ†
        
        if(intersection.empty()) cout << "\næ²¡æœ‰è¦å›æ”¶çš„å·²åˆ†é…åŒº" << endl; // è¾“å‡ºç©ºä¿¡æ¯
        else {
            cout << "\néšæœºå†³å®šå›æ”¶çš„å·²åˆ†é…åŒºçš„åºå·ï¼š";
            for (int val: intersection) { // èŒƒå›´ for å¾ªç¯
                cout << val + 1 ; // è¾“å‡ºè¦å›æ”¶çš„å·²åˆ†é…åŒºåºå·
                if (val!= intersection.back()) cout << " "; // è¾“å‡ºç©ºæ ¼
                else cout << endl;
            }
        }
        return intersection; // è¿”å›è¦éšæœºå›æ”¶çš„å·²åˆ†é…åŒºä¸‹æ ‡
		
    }
};
// ç©ºé—²åŒºç±»
class Free {
public:
    // æ„é€ å‡½æ•°
    Free() {
        cout << endl << m << "ä¸ªç©ºé—²åŒºå†…å­˜å—é»˜è®¤åˆå§‹åŒ–è¯·è¾“å…¥Dï¼Œè¾“å…¥å…¶ä»–ä¸ºè‡ªå®šä¹‰ç©ºé—²åŒºå†…å­˜å—ä¿¡æ¯ï¼š";
        string choice;
        cin >> choice;
        cin.ignore(numeric_limits<streamsize>::max(),  '\n');//while (getchar()!= '\n'); Cè¯­è¨€é£æ ¼ æ¸…ç©ºè¾“å…¥ç¼“å†²åŒº
	    if(choice[0] == 'd' || choice[0] == 'D') initialize_free_table();  // åˆå§‹åŒ–ç©ºé—²åŒºè¡¨
        else customize_free_table();  // è‡ªå®šä¹‰ç©ºé—²åŒºè¡¨
        print_free_table();
    }	
    // ç©ºé—²åŒºè¡¨æ¡ç›®ç»“æ„
    struct FreeEntry{
        float address;  // ç©ºé—²åŒºèµ·å§‹åœ°å€
        float length;   // ç©ºé—²åŒºé•¿åº¦ï¼ˆå­—èŠ‚ï¼‰
        int flag;       // çŠ¶æ€æ ‡è®°ï¼š0-ç©º 1-æœªåˆ†é… å…¶ä»–-æœªå®šä¹‰
        FreeEntry() = default; // æ˜¾å¼å®šä¹‰é»˜è®¤æ„é€ å‡½æ•° 
		FreeEntry(float a, float l, int f) : address(a), length(l), flag(f) {} // æ„é€ å‡½æ•°
    };
    // æ‰“å°ç©ºé—²åŒºè¡¨
    void print_free_table() {
        // éå†ç©ºé—²åŒºè¡¨çš„æ¯ä¸ªæ¡ç›®
        cout << "\nç©ºé—²åŒºè¡¨ï¼š";
        if(free_table.empty()) cout << "æ— " << endl;
        else {
        	cout << "\nåºå·\tèµ·å§‹åœ°å€\té•¿åº¦\t\tçŠ¶æ€" << endl;
        	for (size_t i = 0; i < free_table.size(); i++) {
        // è¾“å‡ºç©ºé—²åŒºçš„èµ·å§‹åœ°å€ã€é•¿åº¦å’ŒçŠ¶æ€
            	cout << " " << i+1 << "\t" 
			//<< fixed 
				<< setprecision(7) << free_table.at(i).address << "\t\t" << free_table.at(i).length << "\t\t" << free_table.at(i).flag;
            //fixed å¼ºåˆ¶ä»¥å®šç‚¹åè¿›åˆ¶æ ¼å¼è¾“å‡ºæµ®ç‚¹æ•°ï¼Œé¿å…é»˜è®¤çš„ç§‘å­¦è®¡æ•°æ³•æ¨¡å¼
            //setprecision(0) è®¾ç½®å°æ•°ç‚¹åçš„ä½æ•°ä¸º 0ï¼Œéšè—å°æ•°éƒ¨åˆ†ï¼ˆè‹¥å­˜åœ¨ï¼‰ï¼Œç›´æ¥è¾“å‡ºæ•´æ•°éƒ¨åˆ†
			//setprecision(n) è®¾ç½®æ€»æœ‰æ•ˆä½æ•°ï¼ˆéå®šç‚¹æ¨¡å¼ä¸‹ï¼‰
            //float ç±»å‹çš„æœ‰æ•ˆä½æ•°çº¦ä¸º 6-7ä½ã€‚è‹¥æ•°å€¼è¶…è¿‡æ­¤èŒƒå›´ï¼ˆå¦‚ 12345678ï¼‰ï¼Œå¼ºåˆ¶è¾“å‡ºå®Œæ•´æ•´æ•°å¯èƒ½å¯¼è‡´ç²¾åº¦ä¸¢å¤±ï¼ˆå¦‚æ˜¾ç¤º 12345680ï¼‰
				switch (free_table.at(i).flag){
                	case 0: cout << "ï¼ˆç©ºï¼‰"; break;
                	case 1: cout << "ï¼ˆæœªåˆ†é…ï¼‰"; break;
                	default: cout << "ï¼ˆæœªå®šä¹‰ï¼‰";
            	}
				cout << endl;	
        	} 	
		}
    }
    bool start(Works& w, Used& u) { // å¼€å§‹åˆ†é…
    	float T = check_total_memory(u);
        cout << "\nåˆå§‹è®¾ç½®çš„å†…å­˜æ€»é‡ä¸ºï¼š" << T << "å­—èŠ‚" << endl;
        int t = 0, I = 0, start = 0; // è®°å½•è½®æ•°
        cout << "\nè¯·é€‰æ‹©è¦æ¼”ç¤ºçš„åŠ¨æ€å†…å­˜åˆ†é…ç®—æ³•ï¼š" << endl
        << "1. é¦–æ¬¡é€‚åº”åˆ†é…ç®—æ³•" << endl << "2. å¾ªç¯é¦–æ¬¡é€‚åº”åˆ†é…ç®—æ³•" << endl << "3. æœ€ä¼˜é€‚åº”åˆ†é…ç®—æ³•" << endl << "4. æœ€åé€‚åº”åˆ†é…ç®—æ³•" << endl
        << "è¾“å…¥åºå·ä»£è¡¨ä½ çš„é€‰æ‹©ï¼Œè¾“å…¥å…¶ä»–å­—ç¬¦å°†é€€å‡ºç¨‹åºï¼š";
        string choice;
        do {
            getline(cin, choice); // è¯»å–æ•´è¡Œè¾“å…¥ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€‚getlineå‡½æ•°é€šå¸¸ç”¨äºè¯»å–å­—ç¬¦ä¸²ï¼Œç›´åˆ°é‡åˆ°æ¢è¡Œç¬¦ï¼Œç„¶åä¸¢å¼ƒæ¢è¡Œç¬¦ã€‚æ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä½¿ç”¨getlineä¹‹åï¼Œç¼“å†²åŒºé‡Œä¸ä¼šæœ‰æ®‹ç•™çš„æ¢è¡Œç¬¦ï¼Œè¿™å¯èƒ½æ„å‘³ç€ä¸éœ€è¦å†æ¸…é™¤ç¼“å­˜äº†
        } while(choice.empty()); // å¾ªç¯ç›´åˆ°è¾“å…¥éç©ºå­—ç¬¦ä¸²
        switch (choice[0]) { // é€‰æ‹©è¦æ¼”ç¤ºçš„åŠ¨æ€å†…å­˜åˆ†é…ç®—æ³•
            case '1': // é¦–æ¬¡é€‚åº”åˆ†é…ç®—æ³•
                while(alloate_first_fit(w, u, I)) { // é¦–æ¬¡é€‚åº”åˆ†é…
                    recycle_free(w, u); // å›æ”¶ç©ºé—²åŒº
                    cout << "\nç¬¬" << ++t << "è½®åˆ†é…å®Œæˆï¼Œå½“å‰å†…å­˜æ€»é‡ä¸ºï¼š" << check_total_memory(u) << "å­—èŠ‚ï¼Œ";
                    if(T == check_total_memory(u)) cout << "å†…å­˜æ€»é‡æœªå˜ï¼Œç¨‹åºæ‰§è¡Œæ•ˆæœè¾¾åˆ°é¢„æœŸï¼" << endl;// å†…å­˜æ€»é‡ä¸å˜
                    else cout << "å†…å­˜æ€»é‡å‘ç”Ÿæ”¹å˜ï¼Œç¨‹åºå‡ºé”™ï¼" << endl; // å†…å­˜æ€»é‡å‡å°‘
                } 
                cout << "\n\né¦–æ¬¡é€‚åº”åˆ†é…ç®—æ³•æ¼”ç¤ºå®Œæ¯•ï¼Œç¨‹åºç»“æŸï¼\nè¾“å…¥ä»»æ„å­—ç¬¦é€€å‡ºç¨‹åºæˆ–åŒå‡»å›è½¦é”®æ¸…å±ç»§ç»­......";
                break;
            case '2': // å¾ªç¯é¦–æ¬¡é€‚åº”åˆ†é…ç®—æ³•
                while(alloate_loop_first_fit(w, u, I, start)) { // å¾ªç¯é¦–æ¬¡é€‚åº”åˆ†é…
                    recycle_free(w, u); // å›æ”¶ç©ºé—²åŒº
                    cout << "\nç¬¬" << ++t << "è½®åˆ†é…å®Œæˆï¼Œå½“å‰å†…å­˜æ€»é‡ä¸ºï¼š" << check_total_memory(u) << "å­—èŠ‚ï¼Œ";
                    if(T == check_total_memory(u)) cout << "å†…å­˜æ€»é‡æœªå˜ï¼Œç¨‹åºæ‰§è¡Œæ•ˆæœè¾¾åˆ°é¢„æœŸï¼" << endl;// å†…å­˜æ€»é‡ä¸å˜
                    else cout << "å†…å­˜æ€»é‡å‘ç”Ÿæ”¹å˜ï¼Œç¨‹åºå‡ºé”™ï¼" << endl; // å†…å­˜æ€»é‡å‡å°‘
                }
                cout << "\n\nå¾ªç¯é¦–æ¬¡é€‚åº”åˆ†é…ç®—æ³•æ¼”ç¤ºå®Œæ¯•ï¼Œç¨‹åºç»“æŸï¼\nè¾“å…¥ä»»æ„å­—ç¬¦é€€å‡ºç¨‹åºæˆ–åŒå‡»å›è½¦é”®æ¸…å±ç»§ç»­......";
                break;
            case '3': // æœ€ä¼˜é€‚åº”åˆ†é…ç®—æ³•
                while(alloate_best_fit(w, u, I)) { // æœ€ä¼˜é€‚åº”åˆ†é…
                    recycle_free(w, u); // å›æ”¶ç©ºé—²åŒº
                    cout << "\nç¬¬" << ++t << "è½®åˆ†é…å®Œæˆï¼Œå½“å‰å†…å­˜æ€»é‡ä¸ºï¼š" << check_total_memory(u) << "å­—èŠ‚ï¼Œ";
                    if(T == check_total_memory(u)) cout << "å†…å­˜æ€»é‡æœªå˜ï¼Œç¨‹åºæ‰§è¡Œæ•ˆæœè¾¾åˆ°é¢„æœŸï¼" << endl;// å†…å­˜æ€»é‡ä¸å˜
                    else cout << "å†…å­˜æ€»é‡å‘ç”Ÿæ”¹å˜ï¼Œç¨‹åºå‡ºé”™ï¼" << endl; // å†…å­˜æ€»é‡å‡å°‘
                }
                cout << "\n\næœ€ä¼˜é€‚åº”åˆ†é…ç®—æ³•æ¼”ç¤ºå®Œæ¯•ï¼Œç¨‹åºç»“æŸï¼\nè¾“å…¥ä»»æ„å­—ç¬¦é€€å‡ºç¨‹åºæˆ–åŒå‡»å›è½¦é”®æ¸…å±ç»§ç»­......";
                break;
            case '4': // æœ€åé€‚åº”åˆ†é…ç®—æ³•
                while(alloate_worst_fit(w, u, I)) { // æœ€åé€‚åº”åˆ†é…
                    recycle_free(w, u); // å›æ”¶ç©ºé—²åŒº
                    cout << "\nç¬¬" << ++t << "è½®åˆ†é…å®Œæˆï¼Œå½“å‰å†…å­˜æ€»é‡ä¸ºï¼š" << check_total_memory(u) << "å­—èŠ‚ï¼Œ";
                    if(T == check_total_memory(u)) cout << "å†…å­˜æ€»é‡æœªå˜ï¼Œç¨‹åºæ‰§è¡Œæ•ˆæœè¾¾åˆ°é¢„æœŸï¼" << endl;// å†…å­˜æ€»é‡ä¸å˜
                    else cout << "å†…å­˜æ€»é‡å‘ç”Ÿæ”¹å˜ï¼Œç¨‹åºå‡ºé”™ï¼" << endl; // å†…å­˜æ€»é‡å‡å°‘
                }
                cout << "\n\næœ€åé€‚åº”åˆ†é…ç®—æ³•æ¼”ç¤ºå®Œæ¯•ï¼Œç¨‹åºç»“æŸï¼\nè¾“å…¥ä»»æ„å­—ç¬¦é€€å‡ºç¨‹åºæˆ–åŒå‡»å›è½¦é”®æ¸…å±ç»§ç»­......";
                break;
            default: // é€€å‡ºç¨‹åº
                cout << "\n\nåˆ†é…ç®—æ³•ç¨‹åºå·²é€€å‡ºï¼Œç¨‹åºç»“æŸï¼" << endl;
                return false;
        }
        char c;
        cin.get(c);  // ç­‰å¾…ç”¨æˆ·è¾“å…¥
        cin.ignore(numeric_limits<streamsize>::max(),  '\n');  // æ¸…ç©ºè¾“å…¥ç¼“å†²åŒº
        /*
è¾“å…¥æµç¨‹åˆ†æï¼šâ€‹â€‹
â€‹â€‹cin.get()çš„ä½œç”¨â€‹â€‹
cin.get()ä¼šä»è¾“å…¥ç¼“å†²åŒºè¯»å–ä¸€ä¸ªå­—ç¬¦ï¼ˆåŒ…æ‹¬å›è½¦ç¬¦\nï¼‰ã€‚å¦‚æœæ­¤æ—¶ç¼“å†²åŒºä¸ºç©ºï¼Œç¨‹åºä¼šé˜»å¡å¹¶ç­‰å¾…ç”¨æˆ·è¾“å…¥ã€‚ç”¨æˆ·è¾“å…¥å›è½¦é”®åï¼Œcin.get()ä¼šè¯»å–è¿™ä¸ªå›è½¦ç¬¦ï¼Œâ€‹â€‹ä½†ä¸ä¼šæ¸…é™¤ç¼“å†²åŒºä¸­çš„æ¢è¡Œç¬¦â€‹â€‹ï¼ˆæ¢è¡Œç¬¦ä»ä¿ç•™åœ¨ç¼“å†²åŒºä¸­ï¼‰ã€‚
â€‹â€‹cin.ignore()çš„ä½œç”¨â€‹â€‹
cin.ignore(numeric_limits<streamsize>::max(), '\n')ä¼šä»ç¼“å†²åŒºä¸­å¿½ç•¥æ‰€æœ‰å­—ç¬¦ï¼Œç›´åˆ°é‡åˆ°æ¢è¡Œç¬¦\næˆ–è¾¾åˆ°æœ€å¤§å­—ç¬¦æ•°ã€‚å¦‚æœç¼“å†²åŒºä¸­å·²æœ‰æ¢è¡Œç¬¦ï¼ˆä¾‹å¦‚ç”¨æˆ·ç¬¬ä¸€æ¬¡æŒ‰å›è½¦é”®æ—¶è¾“å…¥çš„ï¼‰ï¼Œignore()ä¼šç«‹å³æ¸…é™¤è¯¥æ¢è¡Œç¬¦ï¼›å¦‚æœç¼“å†²åŒºä¸ºç©ºï¼Œå®ƒä¼šç­‰å¾…ç”¨æˆ·è¾“å…¥æ–°çš„å­—ç¬¦ï¼Œç›´åˆ°ç”¨æˆ·å†æ¬¡è¾“å…¥å›è½¦é”®ã€‚
â€‹â€‹å…·ä½“æ‰§è¡Œæ­¥éª¤â€‹â€‹ï¼š
â€‹â€‹ç¬¬ä¸€æ¬¡å›è½¦â€‹â€‹
ç”¨æˆ·æŒ‰ä¸‹ç¬¬ä¸€æ¬¡å›è½¦é”®åï¼š
cin.get()è¯»å–æ¢è¡Œç¬¦\nï¼Œç¨‹åºç»§ç»­æ‰§è¡Œã€‚
ä½†â€‹â€‹ç¼“å†²åŒºä¸­ä»ä¿ç•™æ¢è¡Œç¬¦â€‹â€‹ï¼ˆå› ä¸ºcin.get()ä»…è¯»å–ä¸€ä¸ªå­—ç¬¦ï¼Œä½†æœªæ¸…é™¤åç»­å­—ç¬¦ï¼‰ã€‚
â€‹â€‹ç¬¬äºŒæ¬¡å›è½¦â€‹â€‹
ç”¨æˆ·æŒ‰ä¸‹ç¬¬äºŒæ¬¡å›è½¦é”®åï¼š
cin.ignore()æ£€æµ‹åˆ°ç¼“å†²åŒºä¸­çš„ç¬¬ä¸€ä¸ªæ¢è¡Œç¬¦ï¼ˆæ¥è‡ªç¬¬ä¸€æ¬¡è¾“å…¥ï¼‰å¹¶æ¸…é™¤å®ƒã€‚
å¦‚æœæ­¤æ—¶ç¼“å†²åŒºä»ä¸ºç©ºï¼ˆä¾‹å¦‚ç”¨æˆ·ä»…æŒ‰äº†ä¸€æ¬¡å›è½¦ï¼‰ï¼Œignore()ä¼šç»§ç»­ç­‰å¾…è¾“å…¥ï¼Œç›´åˆ°ç”¨æˆ·å†æ¬¡æŒ‰ä¸‹å›è½¦é”®ä»¥äº§ç”Ÿæ–°çš„æ¢è¡Œç¬¦ã€‚
â€‹â€‹æ€»ç»“â€‹â€‹
â€‹â€‹æœ€å°‘éœ€è¦æŒ‰ä¸¤æ¬¡å›è½¦é”®â€‹â€‹ï¼šç¬¬ä¸€æ¬¡è§¦å‘cin.get()ï¼Œç¬¬äºŒæ¬¡è§¦å‘cin.ignore()æ¸…é™¤ç¼“å†²åŒºä¸­çš„æ¢è¡Œç¬¦ã€‚
å¦‚æœç”¨æˆ·ä»…æŒ‰ä¸€æ¬¡å›è½¦é”®ï¼Œcin.ignore()ä¼šå› ç¼“å†²åŒºä¸­æ— æ¢è¡Œç¬¦è€Œç»§ç»­ç­‰å¾…è¾“å…¥ï¼Œç¨‹åºæ— æ³•ç»§ç»­ã€‚
ç‰¹æ€§	      cin.get()	            cin.getline()
â€‹â€‹ç»ˆæ­¢ç¬¦å¤„ç†â€‹â€‹	 ä¿ç•™åœ¨ç¼“å†²åŒº	            ä»ç¼“å†²åŒºç§»é™¤
â€‹â€‹è¿”å›å€¼ç±»å‹â€‹â€‹	 istream&ï¼ˆæ”¯æŒé“¾å¼è°ƒç”¨ï¼‰	istream&
â€‹â€‹ç¼“å†²åŒºæº¢å‡ºä¿æŠ¤â€‹â€‹	è‡ªåŠ¨æ·»åŠ  '\0'	       è‡ªåŠ¨æ·»åŠ  '\0'
â€‹â€‹é€‚ç”¨åœºæ™¯â€‹â€‹   éœ€ä¿ç•™ç»ˆæ­¢ç¬¦æˆ–ç²¾ç¡®æ§åˆ¶è¯»å–èŒƒå›´	éœ€å®Œå…¨æ¸…é™¤ç»ˆæ­¢ç¬¦ï¼ˆå¦‚æ•´è¡Œè¾“å…¥ï¼‰
        */
        if(c == '\n') return true;
        else return false; // é€€å‡ºç¨‹åº
    }
    // ææ„å‡½æ•°
    ~Free() {
        free_table.clear();  // æ¸…ç©ºç©ºé—²åŒºè¡¨
        vector<FreeEntry>().swap(free_table);  // å½»åº•é‡Šæ”¾å†…å­˜ï¼ˆé€šè¿‡ä¸ç©ºå®¹å™¨äº¤æ¢æ•°æ®å®ç°ï¼‰
        cout << "\nç©ºé—²åŒºç±»å·²é”€æ¯" << endl;  // è¾“å‡ºé”€æ¯ä¿¡æ¯
    }
private:
    vector<FreeEntry> free_table;  // ç©ºé—²åŒºè¡¨
    // åˆå§‹åŒ–ç©ºé—²åŒºè¡¨
    void initialize_free_table() {
        cout << "\nå°†é»˜è®¤æŠ˜åŠåˆ†é…1Mçš„æ€»å†…å­˜æˆ" << m << "ä¸ªå†…å­˜å—ï¼Œèµ·å§‹åœ°å€é»˜è®¤ä¸º0" << endl;
    	free_table.resize(m);  // è°ƒæ•´ç©ºé—²åŒºè¡¨å¤§å°ä¸ºmä¸ªæ¡ç›®
        float sizes[] = {L/512, L/256, L/128, L/64, L/32, L/16, L/8, L/4, L/2, L/512}; // å®šä¹‰ä¸åŒå¤§å°çš„å†…å­˜å—æ•°ç»„
        float current_address = 0; // å½“å‰å†…å­˜åœ°å€åˆå§‹åŒ–ä¸º0
        // éå†ç©ºé—²åŒºè¡¨çš„æ¯ä¸ªæ¡ç›®
        for (int i = 0; i < m; i++) {
        // è®¾ç½®ç©ºé—²åŒºçš„èµ·å§‹åœ°å€
            free_table[i].address = current_address;
        // è®¾ç½®ç©ºé—²åŒºçš„é•¿åº¦
            free_table[i].length = sizes[i];
        // æ ‡è®°ä¸ºæœªåˆ†é…
            free_table[i].flag = 1;  
        // æ›´æ–°å½“å‰å†…å­˜åœ°å€
            current_address += sizes[i];  
        }
    }
    // è‡ªå®šä¹‰ç©ºé—²åŒºè¡¨
    void customize_free_table() {
        cout << "\nå°†è‡ªå®šä¹‰è‹¥å¹²ä¸ªç©ºé—²åŒºçš„åˆå§‹ä¿¡æ¯ï¼Œèµ·å§‹åœ°å€é»˜è®¤ä¸º0ï¼Œç©ºé—²åŒºé•¿åº¦ä¸ºå­—ç¬¦ï¼ˆä¸²ï¼‰è¡¨ç¤ºé€€å‡ºè‡ªå®šä¹‰ç©ºé—²åŒº" << endl << endl; 
        float a = 0; // å½“å‰å†…å­˜åœ°å€åˆå§‹åŒ–ä¸º0
        // éå†ç©ºé—²åŒºè¡¨çš„æ¯ä¸ªæ¡ç›®
        int i = 0;
        while(true) {
            float l;
            int F;
            cout << "\nè¯·è¾“å…¥ç¬¬" << i+1 <<"ä¸ªç©ºé—²åŒºçš„é•¿åº¦ï¼š";
            while(1) {
                cin >> l;
                if (cin.fail()) {  // æ£€æµ‹è¾“å…¥æ˜¯å¦å¤±è´¥ï¼ˆå¦‚è¾“å…¥å­—æ¯ï¼‰
                    cin.clear();    // é‡ç½®é”™è¯¯çŠ¶æ€ 
                    cin.ignore(numeric_limits<streamsize>::max(),  '\n');  // æ¸…ç©ºç¼“å†²åŒºç›´è‡³æ¢è¡Œç¬¦ // cin.ignore();ä»…æ¸…ç©º1ä¸ªå­—ç¬¦ï¼ˆå¯èƒ½æ®‹ç•™æ•°æ®ï¼‰
                    i = -1;
                    goto T;
                } else if (l < 0) {
                    cin.ignore(numeric_limits<streamsize>::max(),  '\n');  // æ¸…é™¤å¤šä½™å­—ç¬¦ï¼ˆå¦‚å›è½¦ï¼‰
                    cerr << "ç©ºé—²åŒºé•¿åº¦ä¸èƒ½ä¸ºè´Ÿæ•°ï¼Œè¯·é‡æ–°è¾“å…¥ï¼š";	
                } else {
                    cin.ignore(numeric_limits<streamsize>::max(),  '\n');  // æ¸…é™¤å¤šä½™å­—ç¬¦ï¼ˆå¦‚å›è½¦ï¼‰
                    break;  // è¾“å…¥æ­£ç¡®ï¼Œè·³å‡ºå¾ªç¯
                }
            }
            T:
            if(i == -1) break;
            cout << "è¯·è¾“å…¥è¯¥ç©ºé—²åŒºçš„çŠ¶æ€ï¼ˆ0-ç©ºï¼Œ1-æœªåˆ†é…ï¼Œå…¶ä»–-æœªå®šä¹‰ï¼‰ï¼š";
            while(1) {
            	cin >> F;
            	if (cin.fail())  {  // æ£€æµ‹è¾“å…¥æ˜¯å¦å¤±è´¥ï¼ˆå¦‚è¾“å…¥å­—æ¯ï¼‰
                    cin.clear();    // é‡ç½®é”™è¯¯çŠ¶æ€
                    cin.ignore(numeric_limits<streamsize>::max(),  '\n');  // æ¸…ç©ºç¼“å†²åŒºç›´è‡³æ¢è¡Œç¬¦ // cin.ignore();ä»…æ¸…ç©º1ä¸ªå­—ç¬¦ï¼ˆå¯èƒ½æ®‹ç•™æ•°æ®ï¼‰
                    cerr << "è¯·é‡æ–°è¾“å…¥ä¸€ä¸ªæ•´æ•°ï¼š";
                } else {
                    cin.ignore(numeric_limits<streamsize>::max(),  '\n');  // æ¸…é™¤å¤šä½™å­—ç¬¦ï¼ˆå¦‚å›è½¦ï¼‰
                    break;  // è¾“å…¥æ­£ç¡®ï¼Œè·³å‡ºå¾ªç¯
                }
            }
            free_table.emplace_back(a, l, F); // ç›´æ¥æ„é€ ï¼Œé¿å…æ‹·è´
            a += l; // æ›´æ–°å½“å‰å†…å­˜åœ°å€
            i++;
        }
    }
    // æ£€æŸ¥æ€»å†…å­˜æ˜¯å¦å®Œæ•´
    float check_total_memory(Used& u) {
        float total_memory = 0; // åˆå§‹åŒ–æ€»å†…å­˜
        // éå†ç©ºé—²åŒºè¡¨çš„æ¯ä¸ªæ¡ç›®
        for (size_t i = 0; i < free_table.size(); i++) {
        // ç´¯åŠ ç©ºé—²åŒºçš„é•¿åº¦
            if(free_table.at(i).flag != 0) total_memory += free_table.at(i).length;
        }
        // éå†å·²åˆ†é…åŒºè¡¨çš„æ¯ä¸ªæ¡ç›®
        for (size_t i = 0; i < u.get_used_table().size(); i++) {
        // ç´¯åŠ å·²åˆ†é…åŒºçš„é•¿åº¦
            if(u.get_used_table().at(i).flag == 1) total_memory += u.get_used_table().at(i).length;	
        }
        return total_memory; // è¿”å›æ€»å†…å­˜
    }
    // å¯»æ‰¾æœ€å¤§ç©ºé—²åŒº
    int find_max_free() {
        int max_index = -1; // åˆå§‹åŒ–æœ€å¤§ç©ºé—²åŒºç´¢å¼•ä¸º-1
        float max_length = -1; // åˆå§‹åŒ–æœ€å¤§ç©ºé—²åŒºé•¿åº¦ä¸º-1ï¼Œä¸‡ä¸€æœ€åå¯åˆ†é…çš„ç©ºé—²åŒºé•¿åº¦éƒ½ä¸º0ï¼Œä¹Ÿå¯ä»¥æ­£ç¡®æ‰¾åˆ°ï¼Œç¡®ä¿ä¸ä¼šè¿”å›-1
        // éå†ç©ºé—²åŒºè¡¨çš„æ¯ä¸ªæ¡ç›®
        for (size_t i = 0; i < free_table.size(); i++) {
        // æ£€æŸ¥ç©ºé—²åŒºæ˜¯å¦æœªåˆ†é…ä¸”é•¿åº¦å¤§äºå½“å‰æœ€å¤§é•¿åº¦
            if (free_table.at(i).flag == 1 && free_table.at(i).length > max_length) {
            // æ›´æ–°æœ€å¤§ç©ºé—²åŒºç´¢å¼•å’Œé•¿åº¦
                max_index = i;
                max_length = free_table.at(i).length;	
            } 	
        }
        return max_index; // è¿”å›ç¬¬ä¸€ä¸ªï¼ˆå¦‚æœæœ‰åŒæ—¶ä¸ºæœ€å¤§å€¼çš„æƒ…å†µï¼‰æœ€å¤§ç©ºé—²åŒºç´¢å¼•
    }
    // å¯»æ‰¾æœ€å°ç©ºé—²åŒº
    int find_min_free(Used& u) {
        int min_index = -1; // åˆå§‹åŒ–æœ€å°ç©ºé—²åŒºç´¢å¼•ä¸º-1
        float min_length = check_total_memory(u) + 1; // åˆå§‹åŒ–æœ€å°ç©ºé—²åŒºé•¿åº¦ä¸ºæ€»å†…å­˜é‡åŠ ä¸€ï¼ˆæœ€å¤§å€¼ï¼‰ï¼Œä¸‡ä¸€æœ€åä»…å‰©ä¸‹ä¸€å—å†…å­˜ä¸ºæ€»å†…å­˜é‡çš„ç©ºé—²åŒºï¼Œä¹Ÿä¼šè¢«åˆ†é…ï¼Œç¡®ä¿ä¸ä¼šè¿”å›-1
        // éå†ç©ºé—²åŒºè¡¨çš„æ¯ä¸ªæ¡ç›®
        for (size_t i = 0; i < free_table.size(); i++) {
        // æ£€æŸ¥ç©ºé—²åŒºæ˜¯å¦æœªåˆ†é…ä¸”é•¿åº¦å°äºå½“å‰æœ€å°é•¿åº¦
            if (free_table.at(i).flag == 1 && free_table.at(i).length < min_length) {
            // æ›´æ–°æœ€å°ç©ºé—²åŒºç´¢å¼•å’Œé•¿åº¦
                min_index = i;
                min_length = free_table.at(i).length;	
            } 	
        }
        return min_index; // è¿”å›ç¬¬ä¸€ä¸ªï¼ˆå¦‚æœæœ‰åŒæ—¶ä¸ºæœ€å°å€¼çš„æƒ…å†µï¼‰æœ€å°ç©ºé—²åŒºç´¢å¼•
    }
    // å›æ”¶ç©ºé—²åŒº
    void recycle_free(Works& w, Used& u) { // å›æ”¶ç©ºé—²åŒº
        vector<Used::UsedEntry> r = u.decide_recycle(w); // æŸ¥æ‰¾å·²åˆ†é…çŠ¶æ€çš„å·²åˆ†é…åŒº
        if (r.empty())  return; // æ— å¾…å›æ”¶çš„å·²åˆ†é…åŒº
        // åˆå¹¶ç›¸é‚»ç©ºé—²åŒº
        cout << "\nå¼€å§‹å›æ”¶éšæœºå†³å®šå¥½çš„å·²åˆ†é…åŒºå¹¶åˆå¹¶ç›¸é‚»çš„ç©ºé—²åŒºï¼š" << endl;
        for (size_t i = 0; i < r.size(); i++) { // éå†å¾…å›æ”¶çš„å·²åˆ†é…åŒº
            // è®°å½•åˆå¹¶åçš„èµ·å§‹åœ°å€
            float new_address = r.at(i).address;
            // è®°å½•åˆå¹¶åçš„é•¿åº¦
            float new_length = r.at(i).length;
            // åˆå¹¶ä¸Šé‚»ç©ºé—²åŒº
            for (size_t j = 0; j < free_table.size(); j++) { // éå†å¾…å›æ”¶çš„å·²åˆ†é…åŒº
                // æ‰¾åˆ°ä¸Šé‚»ç©ºé—²åŒº
                if (free_table[j].flag != 0 && 
                    free_table[j].address + free_table[j].length == new_address) {
                    // æ›´æ–°åˆå¹¶åçš„èµ·å§‹åœ°å€
                    new_address = free_table[j].address;
                    // æ›´æ–°åˆå¹¶åçš„é•¿åº¦
                    new_length += free_table[j].length;
                    // æ ‡è®°åŸç©ºé—²åŒºä¸ºç©º
                    free_table[j].flag = 0;
                    free_table[j].address = 0;
                    free_table[j].length = 0;
                    break;
                }
            }
            // åˆå¹¶ä¸‹é‚»ç©ºé—²åŒº
            for (size_t j = 0; j < free_table.size(); j++) { // éå†å¾…å›æ”¶çš„å·²åˆ†é…åŒº
                // æ‰¾åˆ°ä¸‹é‚»ç©ºé—²åŒº
                if (free_table[j].flag != 0 &&
                    free_table[j].address == new_address + new_length) {
                    	// æ›´æ–°åˆå¹¶åçš„é•¿åº¦
                        new_length += free_table[j].length;
                        // æ ‡è®°åŸç©ºé—²åŒºä¸ºç©º
                        free_table[j].flag = 0;
                        free_table[j].address = 0;
                        free_table[j].length = 0;
                        break;
                }
            }
            // å°†åˆå¹¶åçš„ç©ºé—²åŒºæ’å…¥åˆ°ç©ºé—²åŒºè¡¨ä¸­
            for (size_t j = 0; j < free_table.size(); j++)
            {
                if (free_table[j].flag == 0) { // æ‰¾åˆ°ç¬¬ä¸€ä¸ªç©ºçš„ç©ºé—²åŒº
                    // è®¾ç½®åˆå¹¶åçš„ç©ºé—²åŒºçš„èµ·å§‹åœ°å€
                    free_table[j].address = new_address;
                    // è®¾ç½®åˆå¹¶åçš„ç©ºé—²åŒºçš„é•¿åº¦
                    free_table[j].length = new_length;
                    // æ ‡è®°ä¸ºæœªåˆ†é…
                    free_table[j].flag = 1;  
                    // åŠ å…¥æˆåŠŸï¼Œè·³å‡ºå¾ªç¯
                    cout << "ç¼–å·" << r.at(i).id << "ä½œä¸š" << r.at(i).name << "æˆåŠŸå›æ”¶" << r.at(i).length << "å­—èŠ‚å†…å­˜åˆ°ç©ºé—²åŒºè¡¨ä¸­" << endl;
                    break;
                }
                else if (j == free_table.size() - 1 && free_table[j].flag != 0) { // éå†å®Œæ‰€æœ‰ç©ºé—²åŒºéƒ½æœªæ‰¾åˆ°ç©ºçš„ç©ºé—²åŒº
                    cout << "æœªæ‰¾åˆ°æ»¡è¶³ç›¸é‚»ä½ç½®åˆå¹¶æ¡ä»¶çš„ç©ºé—²åŒºï¼Œç°å°†ç¼–å·" << r.at(i).id << "ä½œä¸š" << r.at(i).name << "çš„" << r.at(i).length << "å­—èŠ‚å†…å­˜æ’å…¥åˆ°ç©ºé—²åŒºè¡¨æœ«å°¾æ¥å›æ”¶" << endl;
                    free_table.emplace_back(new_address, new_length, 1); // ç›´æ¥æ„é€ ï¼Œé¿å…æ‹·è´
                    break;
                }
            }
        }
        w.print_jobs(); // æ‰“å°ä½œä¸šé˜Ÿåˆ—
        print_free_table(); // æ‰“å°ç©ºé—²åŒºè¡¨
        cout << "\néšæœºå›æ”¶å·²åˆ†é…çš„å†…å­˜æ‰§è¡Œå®Œæ¯•ï¼" << endl;
    }
    // æ‰“å°æ ‡è¯†
    void print_mark(Works& w, Used& u, int j, int&& i = 1) { // æ‰“å°æ ‡è¯†
        if (i == 0)
        {
            switch(j) {
                case 1: { // é¦–æ¬¡é€‚åº”åˆ†é…
                    cout << "\nå¼€å§‹æ‰§è¡Œé¦–æ¬¡é€‚åº”åˆ†é…ç®—æ³•ï¼š" << endl;	
                    break;
                }
                case 2: { // å¾ªç¯é¦–æ¬¡é€‚åº”åˆ†é…
                    cout << "\nå¼€å§‹æ‰§è¡Œå¾ªç¯é¦–æ¬¡é€‚åº”åˆ†é…ç®—æ³•ï¼š" << endl;
                    break;
                }
                case 3: { // æœ€ä¼˜é€‚åº”åˆ†é…
                    cout << "\nå¼€å§‹æ‰§è¡Œæœ€ä¼˜é€‚åº”åˆ†é…ç®—æ³•ï¼š" << endl;
                    break;
                }
                case 4: { // æœ€åé€‚åº”åˆ†é…
                    cout << "\nå¼€å§‹æ‰§è¡Œæœ€åé€‚åº”åˆ†é…ç®—æ³•ï¼š" << endl;
                    break;
                }
                default: { 
                    cout << "\næœªå®šä¹‰é€‚åº”åˆ†é…ç®—æ³•ï¼" << endl;
                    break;
                }
            } 
        } else { 
            w.print_jobs(); // æ‰“å°ä½œä¸šé˜Ÿåˆ—
            print_free_table(); // æ‰“å°ç©ºé—²åŒºè¡¨
            u.print_used_table(); // æ‰“å°å·²åˆ†é…åŒºè¡¨
            switch(j) {
                case 1: { // é¦–æ¬¡é€‚åº”åˆ†é…
                    cout << "\né¦–æ¬¡é€‚åº”åˆ†é…ç®—æ³•æ‰§è¡Œå®Œæ¯•ï¼" << endl;
                    break;
                }	
                case 2: { // å¾ªç¯é¦–æ¬¡é€‚åº”åˆ†é…
                    cout << "\nå¾ªç¯é¦–æ¬¡é€‚åº”åˆ†é…ç®—æ³•æ‰§è¡Œå®Œæ¯•ï¼" << endl;
                    break;
                }
                case 3: { // æœ€ä¼˜é€‚åº”åˆ†é…
                    cout << "\næœ€ä¼˜é€‚åº”åˆ†é…ç®—æ³•æ‰§è¡Œå®Œæ¯•ï¼" << endl;
                    break;
                }
                case 4: { // æœ€åé€‚åº”åˆ†é…
                    cout << "\næœ€åé€‚åº”åˆ†é…ç®—æ³•æ‰§è¡Œå®Œæ¯•ï¼" << endl;
                    break;
                }
                default: {
                    cout << "\næœªå®šä¹‰é€‚åº”åˆ†é…ç®—æ³•ï¼" << endl;
                    break;	
                }
            }
        }
    }
    // ç»“æŸåˆ†é…ç®—æ³•æ¡ä»¶
    bool end_allocate(Works& w, Used& u, vector<int>& f, int i) { // åˆ¤æ–­è¯¥è½®çš„ä½œä¸šæ˜¯å¦å·²ç»æ»¡è¶³åˆ†é…
        print_mark(w, u, i, 0);
        if(f.empty() || f.size() == 0) { // å¦‚æœæ²¡æœ‰æœªåˆ†é…çŠ¶æ€çš„ä½œä¸š
            cout << "æ‰€æœ‰ä½œä¸šéƒ½å·²åˆ†é…å®Œæˆï¼Œæ— æœªåˆ†é…çŠ¶æ€çš„ä½œä¸šï¼" << endl;
            print_mark(w, u, i);
            return false;
        } else {
            int E = 0; // å¦‚æœç©ºé—²åŒºçš„çŠ¶æ€éƒ½ä¸ºç©ºï¼Œè¯´æ˜æ‰€æœ‰ä½œä¸šéƒ½æ— æ³•åˆ†é…
            for (size_t i = 0; i < free_table.size(); i++) {
                if (free_table.at(i).flag == 1) {
                    E = 1;
                    break;
                }
            }
            if(E == 0) { // è¯´æ˜ç©ºé—²åŒºçš„çŠ¶æ€éƒ½ä¸ºç©ºï¼Œæ‰€æœ‰ä½œä¸šéƒ½æ— æ³•åˆ†é…
                cout << "æ²¡æœ‰å¤„äºæœªåˆ†é…çŠ¶æ€çš„ç©ºé—²åŒºï¼Œæ— æ³•å®Œæˆåˆ†é…" << endl;
                print_mark(w, u, i);
                return false;
            }
			int M, N = 0; // æ ‡è¯†æ˜¯å¦æœ‰ä½œä¸šå†…å­˜éœ€æ±‚å¤§äºæ€»å†…å­˜
        	for(int find: f) {
        		if(!w.get_jobs(find) -> name.empty()) { 
        		if(w.get_jobs(find) -> size > check_total_memory(u) || w.get_jobs(find) -> size > free_table.at(find_max_free()).length) ++M; // æ£€æµ‹æ˜¯å¦æœ‰ä½œä¸šå†…å­˜éœ€æ±‚å¤§äºæ€»å†…å­˜æˆ–å¤§äºæœ€å¤§ç©ºé—²åŒºé•¿åº¦
				} else N++; // è®°å½•æœªå®šä¹‰çš„ä½œä¸š
			}
            if(M == f.size() - N && M != 0) { // è·³è¿‡å…¨æ˜¯æœªå®šä¹‰çš„ä½œä¸šçš„æƒ…å†µ
                cout << "å‰©ä¸‹æœªåˆ†é…ä½œä¸šçš„å†…å­˜éœ€æ±‚éƒ½å¤§äºå½“å‰æœ€å¤§ç©ºé—²åŒº" << free_table.at(find_max_free()).length << "å­—èŠ‚çš„é•¿åº¦ï¼Œæ— æ³•å®Œæˆåˆ†é…" << endl;
                print_mark(w, u, i);
                return false;
            } else if(f.size() == N) { // è¯´æ˜å…¨æ˜¯æœªå®šä¹‰çš„ä½œä¸šçš„æƒ…å†µ
                cout << "æ‰€æœ‰ä½œä¸šéƒ½å·²åˆ†é…å®Œæˆï¼Œæ— æœªåˆ†é…çŠ¶æ€çš„ä½œä¸šï¼" << endl;
                print_mark(w, u, i);
                return false;
            }
        }
        return true; // ä½œä¸šæœªåˆ†é…å®Œæˆ
    }
    // é¦–æ¬¡é€‚åº”åˆ†é…ç®—æ³•
    bool alloate_first_fit(Works& w, Used& u, int& I, int&& J = 1) { // ç”¨å³å€¼å¼•ç”¨&&ä¼ å…¥é¿å…ä¸å¿…è¦çš„æ‹·è´ int I = 0ï¼Œè®°å½•å·²åˆ†é…åŒºè¡¨çš„ç´¢å¼•ï¼ˆé»˜è®¤åˆå§‹ä»ç´¢å¼•0å¼€å§‹è®°å½•å·²åˆ†é…åŒºè¡¨ï¼‰ alloate_first_fit(Works& w, Used& u, int&& I = 0)
        vector<int> f = w.find_jobs(0);
        if (!end_allocate(w, u, f, J)) return false; // åˆ¤æ–­è¯¥è½®çš„ä½œä¸šæ˜¯å¦å·²ç»æ»¡è¶³åˆ†é…
        /*å³å€¼å¼•ç”¨ï¼ˆT&&ï¼‰ç»‘å®šåˆ°å³å€¼ï¼Œå·¦å€¼å¼•ç”¨ï¼ˆT&ï¼‰ç»‘å®šåˆ°å·¦å€¼
          å³å€¼å¼•ç”¨å¯ä»¥ç»‘å®šåˆ°ä¸´æ—¶å¯¹è±¡ã€å­—é¢é‡ã€è¡¨è¾¾å¼ç»“æœç­‰å³å€¼ï¼Œè€Œå·¦å€¼å¼•ç”¨åªèƒ½ç»‘å®šåˆ°å·¦å€¼
          å³å€¼å¼•ç”¨é€šå¸¸ç”¨äºç§»åŠ¨è¯­ä¹‰å’Œå®Œç¾è½¬å‘ï¼Œä»¥æé«˜æ€§èƒ½
          å³å€¼å¼•ç”¨çš„ä¸»è¦ç›®çš„æ˜¯å…è®¸å¯¹å³å€¼è¿›è¡Œä¿®æ”¹å’Œæ“ä½œï¼Œè€Œä¸æ˜¯å¤åˆ¶å®ƒä»¬
          å³å€¼å¼•ç”¨å¯ä»¥å‡å°‘ä¸å¿…è¦çš„å¤åˆ¶æ“ä½œï¼Œæé«˜ç¨‹åºçš„æ•ˆç‡
          å³å€¼å¼•ç”¨å¯ä»¥ä¸ç§»åŠ¨è¯­ä¹‰ç»“åˆä½¿ç”¨ï¼Œå®ç°èµ„æºçš„é«˜æ•ˆè½¬ç§»
        */
        for (int j = 0; j < f.size(); j++) { // éå†æœªåˆ†é…çš„ä½œä¸š
            if(!w.get_jobs(f[j]) -> name.empty()){ // è·³è¿‡æœªå®šä¹‰çš„ä½œä¸š
            	float size = w.get_jobs(f[j]) -> size; // è·å–æœªåˆ†é…ä½œä¸šçš„å†…å­˜éœ€æ±‚
            	for (size_t i = 0; i < free_table.size(); i++) { // éå†ç©ºé—²åŒºè¡¨
        // æ‰¾åˆ°ç¬¬ä¸€ä¸ªè¶³å¤Ÿå¤§çš„æœªåˆ†é…å—
                	if (free_table[i].flag == 1 && free_table[i].length >= size) {
            // è®°å½•åˆ†é…çš„èµ·å§‹åœ°å€
                    	float alloc_address = free_table[i].address;
            // å¦‚æœç©ºé—²åŒºé•¿åº¦ç­‰äºéœ€æ±‚å¤§å°
                    	if (free_table[i].length == size) {
                // æ ‡è®°è¯¥ç©ºé—²åŒºä¸ºç©º
                        	free_table[i].flag = 0;  
                            free_table[i].address = 0;
                            free_table[i].length = 0;
                    	} else {
                // åˆ†å‰²ç©ºé—²åŒºï¼šå‰©ä½™éƒ¨åˆ†åœ°å€åç§»ï¼Œé•¿åº¦å‡å°‘
                        	free_table[i].address += size;
                        	free_table[i].length -= size;
                    	}
            // æ ‡è®°ä½œä¸šä¸ºå·²åˆ†é…
                    	w.modify_jobs(f.at(j), 1); // ç›´æ¥ä¿®æ”¹ä½œä¸šçŠ¶æ€
                        u.modify_used_table(I, w.get_jobs(f.at(j)) -> name, alloc_address, size, w.get_jobs(f.at(j)) -> id); // æ›´æ–°å·²åˆ†é…åŒºè¡¨
                    	cout << "ç¼–å·" << w.get_jobs(f.at(j)) -> id << "ä½œä¸š" << w.get_jobs(f.at(j)) -> name << "å·²åˆ†é…åˆ°åœ°å€" << alloc_address << "ï¼Œå¤§å°ä¸º" << size << "å­—èŠ‚" << endl;
                    	break;  // åˆ†é…å®Œæˆï¼Œè·³å‡ºå¾ªç¯
                	}
            	}
            	if(w.get_jobs(f.at(j)) -> flag == 0) cout << "æœªæ‰¾åˆ°è¶³å¤Ÿå¤§çš„ç©ºé—²å—æ¥æ»¡è¶³ç¼–å·" << w.get_jobs(f.at(j)) -> id << "ä½œä¸š" << w.get_jobs(f.at(j)) -> name << "çš„" << size << "å­—èŠ‚å†…å­˜çš„éœ€æ±‚" << endl;
            }	
        }
        print_mark(w, u, J);
        return true;
    }
    // å¾ªç¯é¦–æ¬¡é€‚åº”åˆ†é…ç®—æ³•
    bool alloate_loop_first_fit(Works& w, Used& u, int& I, int& start, int&& J = 2) { 
        vector<int> f = w.find_jobs(0);
        if (!end_allocate(w, u, f, J)) return false; // åˆ¤æ–­è¯¥è½®çš„ä½œä¸šæ˜¯å¦å·²ç»æ»¡è¶³åˆ†é…
        for (int j = 0; j < f.size(); j++) { // éå†æœªåˆ†é…çš„ä½œä¸š
            if(!w.get_jobs(f[j]) -> name.empty()){ // è·³è¿‡æœªå®šä¹‰çš„ä½œä¸š
            	float size = w.get_jobs(f[j]) -> size; // è·å–æœªåˆ†é…ä½œä¸šçš„å†…å­˜éœ€æ±‚
            	int s = start; // è®°å½•èµ·å§‹ä½ç½®ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦å¾ªç¯æŸ¥æ‰¾ä¸€è½®æ— æœ
                while (1) { // éå†ç©ºé—²åŒºè¡¨
                    int i = start % free_table.size(); // å¾ªç¯éå†
        // æ‰¾åˆ°ä¸‹ä¸€ä¸ªè¶³å¤Ÿå¤§çš„æœªåˆ†é…å—
                	if (free_table[i].flag == 1 && free_table[i].length >= size) {
            // è®°å½•åˆ†é…çš„èµ·å§‹åœ°å€
                    	float alloc_address = free_table[i].address;
            // å¦‚æœç©ºé—²åŒºé•¿åº¦ç­‰äºéœ€æ±‚å¤§å°
                    	if (free_table[i].length == size) {
                // æ ‡è®°è¯¥ç©ºé—²åŒºä¸ºç©º
                        	free_table[i].flag = 0;  
                            free_table[i].address = 0;
                            free_table[i].length = 0;
                    	} else {
                // åˆ†å‰²ç©ºé—²åŒºï¼šå‰©ä½™éƒ¨åˆ†åœ°å€åç§»ï¼Œé•¿åº¦å‡å°‘
                        	free_table[i].address += size;
                        	free_table[i].length -= size;
                    	}
            // æ ‡è®°ä½œä¸šä¸ºå·²åˆ†é…
                    	w.modify_jobs(f.at(j), 1); // ç›´æ¥ä¿®æ”¹ä½œä¸šçŠ¶æ€
                        u.modify_used_table(I, w.get_jobs(f.at(j)) -> name, alloc_address, size, w.get_jobs(f.at(j)) -> id); // æ›´æ–°å·²åˆ†é…åŒºè¡¨
                    	cout << "ç¼–å·" << w.get_jobs(f.at(j)) -> id << "ä½œä¸š" << w.get_jobs(f.at(j)) -> name << "å·²åˆ†é…åˆ°åœ°å€" << alloc_address << "ï¼Œå¤§å°ä¸º" << size << "å­—èŠ‚" << endl;
                    	start++; // æŒ‡å‘ä¸‹ä¸€ä¸ªç©ºé—²åŒº
                        break;  // åˆ†é…å®Œæˆï¼Œè·³å‡ºå¾ªç¯
                	}
                	++start; // ç»§ç»­æŸ¥æ‰¾ä¸‹ä¸€ä¸ªç©ºé—²åŒº
                    if(start - s == free_table.size()) break; // å¾ªç¯æŸ¥æ‰¾ä¸€è½®æ— æœ
            	}
            	if(w.get_jobs(f.at(j)) -> flag == 0) cout << "æœªæ‰¾åˆ°è¶³å¤Ÿå¤§çš„ç©ºé—²å—æ¥æ»¡è¶³ç¼–å·" << w.get_jobs(f.at(j)) -> id << "ä½œä¸š" << w.get_jobs(f.at(j)) -> name << "çš„" << size << "å­—èŠ‚å†…å­˜çš„éœ€æ±‚" << endl;
            }	
        }
        print_mark(w, u, J);
        return true;
    }
    // æœ€ä¼˜é€‚åº”åˆ†é…ç®—æ³•
    bool alloate_best_fit(Works& w, Used& u, int& I, int&& J = 3) { // ç”¨å³å€¼å¼•ç”¨&&ä¼ å…¥é¿å…ä¸å¿…è¦çš„æ‹·è´ int I = 0ï¼Œè®°å½•å·²åˆ†é…åŒºè¡¨çš„ç´¢å¼•ï¼ˆé»˜è®¤åˆå§‹ä»ç´¢å¼•0å¼€å§‹è®°å½•å·²åˆ†é…åŒºè¡¨ï¼‰ alloate_first_fit(Works& w, Used& u, int&& I = 0)
        vector<int> f = w.find_jobs(0);
        if (!end_allocate(w, u, f, J)) return false; // åˆ¤æ–­è¯¥è½®çš„ä½œä¸šæ˜¯å¦å·²ç»æ»¡è¶³åˆ†é…
        for (int j = 0; j < f.size(); j++) { // éå†æœªåˆ†é…çš„ä½œä¸š
            if(!w.get_jobs(f[j]) -> name.empty()){ // è·³è¿‡æœªå®šä¹‰çš„ä½œä¸š
                float size = w.get_jobs(f[j]) -> size; // è·å–æœªåˆ†é…ä½œä¸šçš„å†…å­˜éœ€æ±‚
                int min_index = -1; // åˆå§‹åŒ–æœ€å°ç©ºé—²åŒºç´¢å¼•ä¸º-1
                float min_length = check_total_memory(u) + 1; // åˆå§‹åŒ–æœ€å°ç©ºé—²åŒºé•¿åº¦ä¸ºæ€»å†…å­˜é‡åŠ ä¸€ï¼ˆæœ€å¤§å€¼ï¼‰
                // éå†ç©ºé—²åŒºè¡¨çš„æ¯ä¸ªæ¡ç›®
                for (size_t i = 0; i < free_table.size(); i++) { // éå†ç©ºé—²åŒºè¡¨
                // æ£€æŸ¥ç©ºé—²åŒºæ˜¯å¦æœªåˆ†é…ä¸”é•¿åº¦å°äºå½“å‰æœ€å°é•¿åº¦
                    if (free_table[i].flag == 1 && free_table[i].length >= size && free_table[i].length < min_length) {
                    // æ›´æ–°æœ€å°ç©ºé—²åŒºç´¢å¼•å’Œé•¿åº¦
                        min_index = i; // è®°å½•å¹¶è¿”å›ç¬¬ä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„æœ€å°ç©ºé—²åŒºç´¢å¼•
                        min_length = free_table[i].length; 	
                    }
                }
                if (min_index != -1) { // æ‰¾åˆ°æœ€å°ç©ºé—²åŒº
                    // è®°å½•åˆ†é…çš„èµ·å§‹åœ°å€
                    float alloc_address = free_table[min_index].address;
                    // å¦‚æœç©ºé—²åŒºé•¿åº¦ç­‰äºéœ€æ±‚å¤§å°
                    if (free_table[min_index].length == size) {
                        // æ ‡è®°è¯¥ç©ºé—²åŒºä¸ºç©º
                        free_table[min_index].flag = 0;
                        free_table[min_index].address = 0;
                        free_table[min_index].length = 0; 	
                    } else { // åˆ†å‰²ç©ºé—²åŒºï¼šå‰©ä½™éƒ¨åˆ†åœ°å€åç§»ï¼Œé•¿åº¦å‡å°‘
                        free_table[min_index].address += size;
                        free_table[min_index].length -= size;
                    }
                // æ ‡è®°ä½œä¸šä¸ºå·²åˆ†é…
                w.modify_jobs(f.at(j), 1); // ç›´æ¥ä¿®æ”¹ä½œä¸šçŠ¶æ€
                u.modify_used_table(I, w.get_jobs(f.at(j)) -> name, alloc_address, size, w.get_jobs(f.at(j)) -> id); // æ›´æ–°å·²åˆ†é…åŒºè¡¨
                cout << "ç¼–å·" << w.get_jobs(f.at(j)) -> id << "ä½œä¸š" << w.get_jobs(f.at(j)) -> name << "å·²åˆ†é…åˆ°åœ°å€" << alloc_address << "ï¼Œå¤§å°ä¸º" << size << "å­—èŠ‚" << endl;
                } else { // æœªæ‰¾åˆ°è¶³å¤Ÿå¤§çš„ç©ºé—²å—
                    cout << "æœªæ‰¾åˆ°è¶³å¤Ÿå¤§çš„ç©ºé—²å—æ¥æ»¡è¶³ç¼–å·" << w.get_jobs(f.at(j)) -> id << "ä½œä¸š" << w.get_jobs(f.at(j)) -> name << "çš„" << size << "å­—èŠ‚å†…å­˜çš„éœ€æ±‚" << endl;
                }
            }
        }
        print_mark(w, u, J);
        return true;
    }
    // æœ€åé€‚åº”åˆ†é…ç®—æ³•
    bool alloate_worst_fit(Works& w, Used& u, int& I, int&& J = 4) { // ç”¨å³å€¼å¼•ç”¨&&ä¼ å…¥é¿å…ä¸å¿…è¦çš„æ‹·è´ int I = 0ï¼Œè®°å½•å·²åˆ†é…åŒºè¡¨çš„ç´¢å¼•ï¼ˆé»˜è®¤åˆå§‹ä»ç´¢å¼•0å¼€å§‹è®°å½•å·²åˆ†é…åŒºè¡¨ï¼‰ alloate_first_fit(Works& w, Used& u, int&& I = 0)
        vector<int> f = w.find_jobs(0);
        if (!end_allocate(w, u, f, J)) return false; // åˆ¤æ–­è¯¥è½®çš„ä½œä¸šæ˜¯å¦å·²ç»æ»¡è¶³åˆ†é…
        for (int j = 0; j < f.size(); j++) { // éå†æœªåˆ†é…çš„ä½œä¸š
            if(!w.get_jobs(f[j]) -> name.empty()){ // è·³è¿‡æœªå®šä¹‰çš„ä½œä¸š
                float size = w.get_jobs(f[j]) -> size; // è·å–æœªåˆ†é…ä½œä¸šçš„å†…å­˜éœ€æ±‚
                float alloc_address = free_table[find_max_free()].address; // è®°å½•æœ€å¤§ç©ºé—²åŒºåˆ†é…çš„èµ·å§‹åœ°å€
                float max_length = free_table.at(find_max_free()).length; // è®°å½•æœ€å¤§ç©ºé—²åŒºçš„é•¿åº¦
                if (max_length >= size) { // æ‰¾åˆ°æœ€å¤§ç©ºé—²åŒº
                    // å¦‚æœç©ºé—²åŒºé•¿åº¦ç­‰äºéœ€æ±‚å¤§å°
                    if (max_length == size) {
                        // æ ‡è®°è¯¥ç©ºé—²åŒºä¸ºç©º
                        free_table[find_max_free()].flag = 0;
                        free_table[find_max_free()].address = 0;
                        free_table[find_max_free()].length = 0;	
                    } else { // åˆ†å‰²ç©ºé—²åŒºï¼šå‰©ä½™éƒ¨åˆ†åœ°å€åç§»ï¼Œé•¿åº¦å‡å°‘
                        free_table[find_max_free()].address += size;
                        free_table[find_max_free()].length -= size;
                    }
                // æ ‡è®°ä½œä¸šä¸ºå·²åˆ†é…
                    w.modify_jobs(f.at(j), 1); // ç›´æ¥ä¿®æ”¹ä½œä¸šçŠ¶æ€
                    u.modify_used_table(I, w.get_jobs(f.at(j)) -> name, alloc_address, size, w.get_jobs(f.at(j)) -> id); // æ›´æ–°å·²åˆ†é…åŒºè¡¨
                    cout << "ç¼–å·" << w.get_jobs(f.at(j)) -> id << "ä½œä¸š" << w.get_jobs(f.at(j)) -> name << "å·²åˆ†é…åˆ°åœ°å€" << alloc_address << "ï¼Œå¤§å°ä¸º" << size << "å­—èŠ‚" << endl;
                } else { // æœªæ‰¾åˆ°è¶³å¤Ÿå¤§çš„ç©ºé—²å—
                    cout << "æœªæ‰¾åˆ°è¶³å¤Ÿå¤§çš„ç©ºé—²å—æ¥æ»¡è¶³ç¼–å·" << w.get_jobs(f.at(j)) -> id << "ä½œä¸š" << w.get_jobs(f.at(j)) -> name << "çš„" << size << "å­—èŠ‚å†…å­˜çš„éœ€æ±‚" << endl;
                }
            }
        }
        print_mark(w, u, J);
        return true;
    }
};
// ä¸»å‡½æ•°
int main() {
    while(1){
        this_thread::sleep_for(std::chrono::milliseconds(250));  // æš‚åœ 0.25 ç§’ 
        system("cls");  // æ¸…å±
    	cout << "\n\t---------------åˆ†åŒºç®¡ç†---------------" << endl;
		Works w;  // åˆ›å»ºä½œä¸šå¯¹è±¡
    	Free f;   // åˆ›å»ºç©ºé—²åŒºå¯¹è±¡
        Used u;  // åˆ›å»ºå·²åˆ†é…åŒºå¯¹è±¡
        if(!f.start(w, u)) break; // å¼€å§‹åˆ†é…ç®—æ³•
	}
    system("pause");  // æš‚åœç¨‹åº
    return 0;  // ç¨‹åºç»“æŸ 
}